(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{113:function(e,t,a){e.exports=a.p+"static/media/blank_profile_pic.9a344a6c.jpg"},116:function(e,t,a){e.exports=a(211)},121:function(e,t,a){},196:function(e,t,a){},208:function(e,t,a){},211:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(32),r=a.n(i),o=(a(121),a(5)),l=a(6),c=a(9),u=a(7),d=a(8),h=a(226),p=a(171),m=a(170),f=a(105),b=a(153),v=a(227),g=a(213),y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleItemClick=function(e){return function(){a.props.history.push("/".concat(e))}},a.logout=function(){return function(){window.localStorage.removeItem("key_credentials"),window.localStorage.removeItem("permissions"),a.props.history.push("/")}},a.state={activeItem:"home"},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){if(!this.props.show)return this.props.children;var e=window.localStorage.getItem("permissions"),t=null===e?[]:e.split(","),a=[];t.indexOf("view_attendanceitems")>=0&&a.push(s.a.createElement(f.a,{key:0,onClick:this.handleItemClick("attendance")},"Attendance")),t.indexOf("view_students")>=0&&a.push(s.a.createElement(f.a,{key:1,onClick:this.handleItemClick("students")},"Students")),(t.indexOf("view_group")>=0||t.indexOf("view_user")>=0)&&a.push(s.a.createElement(f.a,{key:2,onClick:this.handleItemClick("admin")},"Admin"));var n=s.a.createElement(b.a,null,a,s.a.createElement(f.a,{onClick:this.handleItemClick("reports")},"Reports"));return s.a.createElement("div",null,s.a.createElement(v.a,null,s.a.createElement(v.a.Header,null,s.a.createElement(v.a.Brand,{onClick:this.handleItemClick("attendance")},"Key"),s.a.createElement(v.a.Toggle,null)),s.a.createElement(v.a.Collapse,null,n,s.a.createElement(b.a,{pullRight:!0},s.a.createElement(f.a,{onClick:this.logout()},"Logout")))),this.props.children)}}]),t}(n.Component),k=Object(g.a)(y),w=a(2),O=a(214),S=a(215),E=a(216),C=a(229),j=a(217),_=a(218),D=a(231),I=a(16),x=a.n(I),M=a(21),N=a(111),A=a.n(N)()(),U="app.jordansybesma.com";function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=window.localStorage.getItem("key_credentials");if(null!==a)return fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"JWT "+a},body:JSON.stringify(t)}).then(function(e){return e.status>=400?(403===e.status&&(L(),A.push("/")),{error:e.status}):e.json()});A.push("/")}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=window.localStorage.getItem("key_credentials");if(null!==a)return fetch(e,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"JWT "+a},body:JSON.stringify(t)}).then(function(e){return e.status>=400?(403===e.status&&(L(),A.push("/")),{error:e.status}):e?e.json():void 0});A.push("/")}function F(e){var t=window.localStorage.getItem("key_credentials");if(null!==t)return fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"JWT "+t}}).then(function(e){return e.status>=400?(403===e.status&&(L(),A.push("/")),{error:e.status}):e.json()});A.push("/")}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=window.localStorage.getItem("key_credentials");if(null!==a)return fetch(e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"JWT "+a},body:JSON.stringify(t)}).then(function(e){return e.status>=400?(403===e.status&&(L(),A.push("/")),{error:e.status}):{}});A.push("/")}function W(e,t){return e.ordering<t.ordering?-1:e.ordering>t.ordering?1:0}function L(){window.localStorage.removeItem("key_credentials"),window.localStorage.removeItem("permissions")}function H(e){return V.apply(this,arguments)}function V(){return(V=Object(M.a)(x.a.mark(function e(t){var n,s,i,r,o,l,c,u,d,h,p,m,f,b,v,g,y,k=arguments;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=k.length>1&&void 0!==k[1]?k[1]:null,s=t===n||null===n?"https://".concat(U,"/api/attendance/?day=").concat(t):"https://".concat(U,"/api/attendance/?startdate=").concat(t,"&enddate=").concat(n),e.next=4,F(s);case 4:return i=e.sent,e.next=7,F("https://".concat(U,"/api/students/"));case 7:return r=e.sent,e.next=10,F("https://".concat(U,"/api/activities/"));case 10:if((o=e.sent).sort(W),0!==i.length&&0!==o.length){e.next=14;break}return e.abrupt("return");case 14:for(l={},c=0;c<o.length;c++)o[c].is_showing&&(l[o[c].name]={id:o[c].activity_id,ordering:o[c].ordering,type:o[c].type});for(u={},c=0;c<i.length;c++)null==u["".concat(i[c].student_id).concat(i[c].date)]&&(u["".concat(i[c].student_id).concat(i[c].date)]={date:i[c].date,id:i[c].student_id}),null!==i[c].str_value?u["".concat(i[c].student_id).concat(i[c].date)][i[c].activity_id]=i[c].str_value:null!==i[c].num_value?u["".concat(i[c].student_id).concat(i[c].date)][i[c].activity_id]=i[c].num_value:u["".concat(i[c].student_id).concat(i[c].date)][i[c].activity_id]="Y";for(d=[],h=["Date","First","Last","Student Key"],c=0;c<o.length;c++)o[c].is_showing&&h.push(o[c].name);p=Object.keys(u),c=0;case 23:if(!(c<p.length)){e.next=54;break}m=[],f=0;case 26:if(!(f<r.length)){e.next=35;break}if(r[f].id!==u[p[c]].id){e.next=32;break}return m[1]=r[f].first_name,m[2]=r[f].last_name,m[3]=null!==r[f].student_key?r[f].student_key:"N/A",e.abrupt("break",35);case 32:f++,e.next=26;break;case 35:f=0;case 36:if(!(f<h.length)){e.next=50;break}e.t0=h[f],e.next="Date"===e.t0?40:"First"===e.t0?42:"Last"===e.t0?43:"Student Key"===e.t0?44:45;break;case 40:return m[f]=u[p[c]].date,e.abrupt("break",47);case 42:case 43:case 44:return e.abrupt("break",47);case 45:b=l[h[f]],void 0===u[p[c]][b.id]?"boolean"===b.type?m[f]="N":m[f]="N/A":m[f]=u[p[c]][b.id];case 47:f++,e.next=36;break;case 50:d.push(m);case 51:c++,e.next=23;break;case 54:console.log("sheet: ",d),console.log("columns: ",h),v=a(70),g=v.unparse({fields:h,data:d}),(y=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(g)),y.setAttribute("download","Attendance_".concat(t===n||null===n?t:"".concat(t,"_").concat(n),".csv")),y.style.display="none",document.body.appendChild(y),y.click(),document.body.removeChild(y);case 65:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function B(e,t,n){var s=a(70).unparse({fields:t,data:e}),i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(s)),i.setAttribute("download","".concat(n,".csv")),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}var J=function(e){var t=window.localStorage.getItem("key_credentials");return null===t?s.a.createElement(D.a,{to:"/"}):function(e){var t=e.split(".");return JSON.parse(atob(t[1]))}(t).exp<Date.now()/1e3?(L(),s.a.createElement(D.a,{to:"/"})):s.a.createElement(e,null)};function K(e){e<0&&(console.error("Expected daysAgo to be a value >= 0 but recieved ",e),e=-e);var t=new Date;return t.setDate(t.getDate()-e),t}function Y(e){var t=e.getDay();return e.setDate(e.getDate()-t),e}function q(e){var t=6-e.getDay();return e.setDate(e.getDate()+t),e}var z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={username:"",password:"",error:!1,firstLogin:!0},a.onUsernameChange=a.onUsernameChange.bind(Object(w.a)(Object(w.a)(a))),a.onPasswordChange=a.onPasswordChange.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){null!=localStorage.getItem("loggedIn")&&this.setState({firstLogin:!1})}},{key:"onUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"onPasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"submit",value:function(e){var t=this;e.preventDefault(),fetch("https://".concat(U,"/api-token-auth/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.state.username,password:this.state.password})}).then(function(e){e.status>=400?t.setState({error:!0,username:"",password:""}):e.json().then(function(e){window.localStorage.setItem("key_credentials",e.token),window.localStorage.setItem("permissions",e.permissions),window.localStorage.setItem("loggedIn","true"),t.props.history.push("/attendance")})})}},{key:"render",value:function(){var e=this,t={textAlign:"center"};return null!==window.localStorage.getItem("key_credentials")?s.a.createElement(D.a,{to:"/attendance"}):s.a.createElement("div",{className:"center"},s.a.createElement("div",{className:"login-container"},s.a.createElement(O.a,null,s.a.createElement("h2",{style:t},"Key Attendance"),s.a.createElement("h4",{style:t},"Sign In"),s.a.createElement("form",{onSubmit:function(t){return e.submit(t)}},s.a.createElement(S.a,null,s.a.createElement(E.a,null,"Username"),s.a.createElement(C.a,{type:"text",value:this.state.username,placeholder:"Username",onChange:this.onUsernameChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Password"),s.a.createElement(C.a,{type:"password",value:this.state.password,placeholder:"Password",onChange:this.onPasswordChange})),s.a.createElement(j.a,{block:!0,type:"submit",bsStyle:"primary"},"Continue"),s.a.createElement("br",null),this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},"Invalid username or password. Please try again."),!this.state.firstLogin&&s.a.createElement(_.a,{bsStyle:"info"},"You have been logged out.")))))}}]),t}(s.a.Component),Q=a(29),$=a.n(Q),G=a(25),X=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={isChecked:!1,value:"",activityType:""},a.toggleCheckboxChange=function(){var e=a.props,t=e.toggleCheckbox,n=e.label;t(a.state.isChecked,n,a.state.value,a.state.activityType)},a.handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(G.a)({},e);return a[t]=n,a})},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({isChecked:this.props.checked,value:this.props.value,activityType:this.props.activityType})}},{key:"componentDidUpdate",value:function(){this.props.checked!==this.state.isChecked&&this.setState({isChecked:this.props.checked,value:this.props.value,activityType:this.props.activityType})}},{key:"render",value:function(){var e,t=this.props.label,a=this.state,n=a.isChecked,i=a.value,r=a.activityType,o=s.a.createElement("span",{className:"checkbox"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",value:t,checked:n,onChange:this.toggleCheckboxChange}),t));return"boolean"===r?s.a.createElement("span",{className:"checkbox"},o):(e="string"===r?s.a.createElement("input",{type:"text",value:i,name:"value",disabled:n,onChange:this.handleChange}):s.a.createElement("input",{type:"number",value:i,disabled:n,name:"value",onChange:this.handleChange}),s.a.createElement("span",{className:"checkbox"},o,e))}}]),t}(n.Component),Z=a(219),ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleCheckbox=function(e,t,n,s){var i=a.state,r=i.activities,o=i.studentID,l=i.numChecked,c=i.date,u=Object(w.a)(Object(w.a)(a)),d=r[t].activityID,h=r[t].attendanceItemID;if(e)1===l||R("https://".concat(U,"/api/attendance/?key=").concat(h)).then(function(e){"error"in e?u.setState({error:e.error}):(r[t].value="boolean"!==s&&"",u.setState({activities:r,numChecked:l-1}))});else{var p=new Date,m={student_id:o,activity_id:d,date:"".concat(c),time:"".concat(p.getHours(),":").concat(p.getMinutes()>=10?p.getMinutes():"0".concat(p.getMinutes()),":").concat(p.getSeconds()>=10?p.getSeconds():"0".concat(p.getSeconds()))};if("string"===s){if(""===n)return;m.str_value=n}else if("float"===s){if(""===n)return;m.num_value=n}T("https://".concat(U,"/api/attendance/"),m).then(function(e){"error"in e?u.setState({error:e.error}):("boolean"===s?r[t].value=!0:"string"===s?r[t].value=e.str_value:"float"===s&&(r[t].value=e.num_value),r[t].attendanceItemID=e.id,u.setState({activities:r,numChecked:l+1}))})}},a.createCheckboxes=function(){for(var e=a.state.activities,t=Object.keys(e),n=[],i=0;i<t.length;i++){var r=e[t[i]].type,o=e[t[i]].value,l=void 0;l="boolean"===r?o:""!==o,n.push(s.a.createElement(X,{label:t[i],key:t[i],activityType:r,value:o,checked:l,toggleCheckbox:a.toggleCheckbox}))}return n},a.state={activities:{},studentID:0,error:"",numChecked:0,date:""},a.toggleCheckbox=a.toggleCheckbox.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){for(var e=0,t=this.props.row.activities,a=Object.keys(t),n=0;n<a.length;n++)"boolean"===t[a[n]].type?!0===t[a[n]].value&&e++:""!==t[a[n]].value&&e++;this.setState({activities:t,studentID:this.props.row.studentID,numChecked:e,date:this.props.row.date})}},{key:"render",value:function(){return s.a.createElement("span",{className:"container"},s.a.createElement("span",{className:"row"},s.a.createElement("span",{className:"col-sm-12"},this.state.numChecked<2&&s.a.createElement(Z.a,{bsStyle:"warning"},"At least one box must be checked"),""!==this.state.error&&s.a.createElement(Z.a,{bsStyle:"danger"},"Error ",this.state.error,": Your changes have not been saved. Please refresh and try again."),this.createCheckboxes())))}}]),t}(s.a.Component),te=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={row:{}},a.deleteRow=a.deleteRow.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"componentDidUpdate",value:function(){this.props.row.studentID!==this.state.row.studentID&&this.setState({row:this.props.row})}},{key:"deleteRow",value:function(){for(var e=this.state.row,t=e.activities,a=Object.keys(t),n=[],s=0;s<a.length;s++)0!==t[a[s]].attendanceItemID&&n.push(t[a[s]].attendanceItemID);for(var i=0;i<n.length;i++)R("https://".concat(U,"/api/attendance/?key=").concat(n[i]));this.props.CustomFunction(e.studentID)}},{key:"render",value:function(){return s.a.createElement(j.a,{bsStyle:"danger",onClick:this.deleteRow},"Delete")}}]),t}(s.a.Component),ae=a(228),ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleInfoChange=function(e){var t=e.target.name,n=e.target.value,s=a.state.studentInfo;s[t]=n,a.setState({studentInfo:s})},a.state={firstName:"",lastName:"",show:!1,studentFields:{},studentInfo:{}},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.onFirstNameChange=a.onFirstNameChange.bind(Object(w.a)(Object(w.a)(a))),a.onLastNameChange=a.onLastNameChange.bind(Object(w.a)(Object(w.a)(a))),a.handleInfoChange=a.handleInfoChange.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.show!==this.state.show){var e={},t=this.props.studentFields,a={};for(var n in t)e[t[n].name]="",a[t[n].name]=t[n];this.setState({show:this.props.show,studentFields:a,studentInfo:e})}}},{key:"validateInput",value:function(){var e=this.state,t=e.firstName,a=e.lastName;return t.length>0&&a.length>0?"success":0===t.length&&0===a.length?null:"error"}},{key:"onFirstNameChange",value:function(e){this.setState({firstName:e.target.value})}},{key:"onLastNameChange",value:function(e){this.setState({lastName:e.target.value})}},{key:"cancel",value:function(){this.setState({firstName:"",lastName:""}),this.props.onSubmit()}},{key:"createStudentInfo",value:function(e,t,a,n){var s=n.state.studentFields[e],i={student_id:a,info_id:s.info_id};return"str"===s.type?i.str_value=t:"int"===s.type?i.int_value=t:"date"===s.type&&(i.date_value=t),i}},{key:"submit",value:function(){var e=this;T("https://".concat(U,"/api/students/"),{first_name:this.state.firstName,last_name:this.state.lastName}).then(function(t){if("error"in t)console.log(t);else{var a=t.id,n=e.state.studentInfo,s=[];for(var i in n)""!==n[i]&&s.push(e.createStudentInfo(i,n[i],a,e));T("https://".concat(U,"/api/student_info/"),s).then(function(a){"error"in a?console.log(a):(e.setState({firstName:"",lastName:""}),e.props.onSubmit(t))})}})}},{key:"createStudentInfoFields",value:function(){var e=[],t=this.state.studentFields;for(var a in t){var n=t[a],i=void 0;switch(n.type){case"str":i="text";break;case"int":i="int";break;case"date":i="date"}e.push(s.a.createElement("div",{key:n.info_id},s.a.createElement(E.a,null,a),s.a.createElement(C.a,{value:this.state.studentInfo[a],name:a,type:i,onChange:this.handleInfoChange}),s.a.createElement("br",null)))}return e}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New Student")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(S.a,{controlId:"addStudentForm",validationState:this.validateInput()},s.a.createElement(E.a,null,"First Name"),s.a.createElement(C.a,{type:"text",value:this.state.firstName,placeholder:"First",onChange:this.onFirstNameChange}),s.a.createElement(C.a.Feedback,null),s.a.createElement("br",null),s.a.createElement(E.a,null,"Last Name"),s.a.createElement(C.a,{type:"text",value:this.state.lastName,placeholder:"Last",onChange:this.onLastNameChange}),s.a.createElement("br",null),this.createStudentInfoFields(),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,s.a.createElement(j.a,{onClick:this.cancel},"Cancel"),s.a.createElement(j.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),se=(a(196),a(220)),ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=a.props.suggestions,n=e.currentTarget.value,s=t.filter(function(e){return!0===e.firstName.toLowerCase().startsWith(n.toLowerCase())||!0===e.lastName1.toLowerCase().startsWith(n.toLowerCase())||!0===e.lastName2.toLowerCase().startsWith(n.toLowerCase())||!0===(e.firstName.toLowerCase()+" "+e.lastName1.toLowerCase()+" ").startsWith(n.toLowerCase())||e.username&&!0===e.username.toLowerCase().startsWith(n.toLowerCase())});a.setState({activeSuggestion:0,filteredSuggestions:s,showSuggestions:!0,userInput:e.currentTarget.value})},a.onClick=function(e){a.setState({activeSuggestion:0,filteredSuggestions:[],showSuggestions:!1,userInput:e.currentTarget.innerText}),a.props.handler(e,e._targetInst.key),a.setState({userInput:""})},a.handleSubmit=function(e){e.preventDefault()},a.onKeyDown=function(e){var t=a.state,n=t.activeSuggestion,s=t.filteredSuggestions;if(13===e.keyCode&&-1===a.state.activeSuggestion)a.props.handler(e,a.state.selectedId),a.setState({userInput:""});else if(13===e.keyCode){if("object"===typeof s[n]){var i=s[n].firstName+" "+s[n].lastName1;a.setState({activeSuggestion:-1,showSuggestions:!1,userInput:i,selectedId:s[n].id})}}else if(38===e.keyCode){if(0===n)return;a.setState({activeSuggestion:n-1}),a.scrollUpHandler()}else if(40===e.keyCode){if(n===s.length-1)return;a.setState({activeSuggestion:n+1}),a.scrollDownHandler()}},a.state={activeSuggestion:0,filteredSuggestions:[],showSuggestions:!1,userInput:""},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"scrollDownHandler",value:function(){var e=document.getElementsByClassName("suggestions"),t=document.getElementsByClassName("suggestion-active")[0].getBoundingClientRect().height,a=e[0].scrollTop,n=e[0].getBoundingClientRect().height,s=Math.round(Math.round(n/t)/2)*t;(this.state.activeSuggestion+2)*t>=a+n&&(e[0].scrollTop=e[0].scrollTop+s)}},{key:"scrollUpHandler",value:function(){var e=document.getElementsByClassName("suggestions"),t=document.getElementsByClassName("suggestion-active")[0].getBoundingClientRect().height,a=e[0].scrollTop,n=e[0].getBoundingClientRect().height,s=Math.round(Math.round(n/t)/2)*t;(this.state.activeSuggestion-1)*t<=a&&(e[0].scrollTop=e[0].scrollTop-s)}},{key:"render",value:function(){var e,t=this.onChange,a=this.onClick,i=this.onKeyDown,r=this.handleSubmit,o=this.state,l=o.activeSuggestion,c=o.filteredSuggestions,u=o.showSuggestions,d=o.userInput;return u&&d&&(e=c.length?s.a.createElement("div",{className:"suggestions"},c.map(function(e,t){var n;t===l&&(n="suggestion-active");var i="";return e.username&&(i=" | "+e.username),s.a.createElement("p",{className:n,key:e.id,onClick:a},e.firstName," ",e.lastName1," ",e.lastName2," ",i)})):s.a.createElement("div",{className:"no-suggestions"},s.a.createElement("em",null,"No suggestions."))),s.a.createElement(n.Fragment,null,s.a.createElement(se.a,{inline:!0,onSubmit:r},s.a.createElement(S.a,{controlId:"formInlineName"},s.a.createElement(E.a,null,"Search:")," ",s.a.createElement(C.a,{autoComplete:"off",type:"text",value:d,onChange:t,onKeyDown:i,placeholder:this.props.hasUsername?"Name or Username":"Name"}),e)," "))}}]),t}(n.Component);ie.defaultProps={suggestions:[],handler:null};var re=ie,oe=a(221),le=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={buildingCSV:!1,students:[],activities:[],attendanceItems:[],suggestionsArray:[],attendance:[],showStudentModal:!1,date:"",prevDate:""},a.downloadCSV=a.downloadCSV.bind(Object(w.a)(Object(w.a)(a))),a.addStudent=a.addStudent.bind(Object(w.a)(Object(w.a)(a))),a.removeAttendanceRow=a.removeAttendanceRow.bind(Object(w.a)(Object(w.a)(a))),a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.updateDate=a.updateDate.bind(Object(w.a)(Object(w.a)(a))),a.setDateToToday=a.setDateToToday.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({date:this.getCurrentDate()})}},{key:"componentDidUpdate",value:function(){this.state.date!==this.state.prevDate&&(this.setState({prevDate:this.state.date}),this.fetchAndBuild())}},{key:"getCurrentDate",value:function(){var e=new Date,t=e.getMonth()+1,a=e.getDate();return"".concat(e.getFullYear(),"-").concat(t>=10?t:"0".concat(t),"-").concat(a>=10?a:"0".concat(a))}},{key:"fetchAndBuild",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a,n,s,i,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.date,e.prev=1,e.next=4,F("https://".concat(U,"/api/students/"));case 4:return a=e.sent,e.next=7,F("https://".concat(U,"/api/attendance/?day=").concat(t));case 7:return n=e.sent,e.next=10,F("https://".concat(U,"/api/activities/"));case 10:return s=e.sent,e.next=13,F("https://".concat(U,"/api/student_column/?quick_add=True"));case 13:i=e.sent,(s=s.filter(function(e){return!0===e.is_showing})).sort(W),r=this.makeSuggestionsArray(a),this.setState({suggestionsArray:r,students:a,activities:s,studentFields:i,attendanceItems:n}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),console.log(e.t0);case 23:this.buildSheet();case 24:case"end":return e.stop()}},e,this,[[1,20]])}));return function(){return e.apply(this,arguments)}}()},{key:"buildSheet",value:function(){for(var e=this.state,t=e.activities,a=e.attendanceItems,n=e.students,s={},i=0;i<a.length;i++)if(-1!==a[i].activity_id){null==s["".concat(a[i].student_id)]&&(s["".concat(a[i].student_id)]={time:a[i].time});var r=!0;null!==a[i].num_value?r=a[i].num_value:null!==a[i].str_value&&(r=a[i].str_value),s["".concat(a[i].student_id)][a[i].activity_id]={value:r,itemID:a[i].id}}var o=[],l=Object.keys(s),c=["Name"];for(i=0;i<t.length;i++)c.push(t[i].name);for(i=0;i<l.length;i++){for(var u={},d=0;d<n.length;d++)if(n[d].id===parseInt(l[i])){u.name="".concat(n[d].first_name," ").concat(n[d].last_name),u.studentID=n[d].id;break}u.time=s[l[i]].time,u.activities={};for(d=0;d<t.length;d++){var h=void 0;h=s[l[i]][t[d].activity_id]?s[l[i]][t[d].activity_id].value:"boolean"!==t[d].type&&"",u.activities[t[d].name]={value:h,activityID:t[d].activity_id,type:t[d].type,attendanceItemID:s[l[i]][t[d].activity_id]?s[l[i]][t[d].activity_id].itemID:0}}o.push(u)}this.setState({attendance:o})}},{key:"addStudent",value:function(e,t){for(var a=this.state,n=a.students,s=a.attendance,i=a.activities,r=a.date,o=new Date,l=this,c=0;c<s.length;c++)if(parseInt(t)===s[c].studentID)return;T("https://".concat(U,"/api/attendance/"),{student_id:t,activity_id:7,date:"".concat(r),time:"".concat(o.getHours(),":").concat(o.getMinutes()>=10?o.getMinutes():"0".concat(o.getMinutes()),":").concat(o.getSeconds()>=10?o.getSeconds():"0".concat(o.getSeconds()))}).then(function(e){for(var a="",r=0;r<n.length;r++)if(n[r].id===parseInt(t)){a="".concat(n[r].first_name," ").concat(n[r].last_name);break}var o={};for(r=0;r<i.length;r++){var c=i[r].type,u="boolean"!==c&&"";o[i[r].name]={activityID:i[r].activity_id,attendanceItemID:0,value:u,type:c}}o.Key.value=!0,o.Key.attendanceItemID=e.id;var d={name:a,studentID:parseInt(t),time:e.time,activities:o};s.push(d),l.setState({attendance:s})})}},{key:"makeSuggestionsArray",value:function(e){var t,a,n,s=[];for(var i in e)e[i].last_name.includes(" ")?(t=(n=e[i].last_name.split(" "))[0],a=n[1]):(t=e[i].last_name,a=""),s.push({firstName:e[i].first_name,lastName1:t,lastName2:a,id:e[i].id});return s}},{key:"downloadCSV",value:function(){var e=Object(M.a)(x.a.mark(function e(){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({buildingCSV:!0}),e.next=3,H("".concat(this.state.date));case 3:this.setState({buildingCSV:!1});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removeAttendanceRow",value:function(e){for(var t=this.state.attendance,a=0;a<t.length;a++)t[a].studentID===e&&t.splice(a,1);this.setState({attendance:t})}},{key:"openModal",value:function(){this.setState({showStudentModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.students,a=[];null!==e&&(t.push({first_name:e.first_name,last_name:e.last_name,id:e.id}),a=this.makeSuggestionsArray(t),this.addStudent(null,e.id)),this.setState({showStudentModal:!1,students:t,suggestions:a})}},{key:"updateDate",value:function(e){this.setState({date:e.target.value})}},{key:"setDateToToday",value:function(){this.setState({date:this.getCurrentDate()})}},{key:"render",value:function(){var e=this;if(window.localStorage.getItem("permissions").split(",").indexOf("view_attendanceitems")<0)return s.a.createElement(D.a,{to:"/attendance"});var t=this.state.attendance.map(function(t){return{name:t.name,time:t.time,activities:t.activities,studentID:t.studentID,date:e.state.date}}).sort(function(e,t){return t.time.localeCompare(e.time)}),a=[{accessor:"name",label:"Name",priorityLevel:1,position:1,minWidth:100,sortable:!0},{accessor:"time",label:"Check-in Time",priorityLevel:2,position:2,minWidth:100,sortable:!0},{accessor:"options",label:"Options",priorityLevel:3,position:3,CustomComponent:te,sortable:!1,minWidth:100},{accessor:"activities",label:"Activities",priorityLevel:4,position:4,minWidth:2e3,CustomComponent:ee,sortable:!1}],n=this.state.buildingCSV;return s.a.createElement("div",{className:"content"},s.a.createElement(ne,{studentFields:this.state.studentFields,show:this.state.showStudentModal,onSubmit:this.closeModal}),s.a.createElement("h1",null,"Attendance for ",this.state.date),s.a.createElement("br",null),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:this.setDateToToday},"Go To Today"),s.a.createElement(j.a,{onClick:this.downloadCSV,disabled:n},n?"Downloading...":"Download"),s.a.createElement(j.a,{onClick:this.openModal},"New Student")),s.a.createElement(se.a,{inline:!0,style:{float:"right",paddingRight:"5px",paddingLeft:"5px"}},s.a.createElement(S.a,null,s.a.createElement(E.a,null,"Date:")," ",s.a.createElement(C.a,{onChange:this.updateDate,value:this.state.date,type:"date"}))),s.a.createElement(re,{suggestions:this.state.suggestionsArray,handler:this.addStudent}),s.a.createElement("br",null),s.a.createElement($.a,{rows:t,columns:a,column:"time",direction:"descending",showPagination:!0,callbacks:{options:this.removeAttendanceRow}}))}}]),t}(s.a.Component),ce=(a(23),a(33)),ue=a(84),de=a.n(ue),he=(a(208),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={data:e.data,yArrayStudents:["1","2","3","4","5"]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"setYArrayRange",value:function(e){try{if("Thu"===e[0].y)return["Thu","Fri","Sat","Sun","Mon","Tue","Wed"];if("Fri"===e[0].y)return["Fri","Sat","Sun","Mon","Tue","Wed","Thu"];if("Sat"===e[0].y)return["Sat","Sun","Mon","Tue","Wed","Thu","Fri"];if("Sun"===e[0].y)return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];if("Mon"===e[0].y)return["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];if("Tue"===e[0].y)return["Tue","Wed","Thu","Fri","Sat","Sun","Mon"];if("Wed"===e[0].y)return["Wed","Thu","Fri","Sat","Sun","Mon","Tue"]}catch(t){console.log(t)}}},{key:"scaleWidth",value:function(e,t){return"weekly"===e||"individualStudent"===e?8*t:"annual"===e?3.2*t:void 0}},{key:"scaleHeight",value:function(e){return"weekly"===e||"individualStudent"===e?300:"annual"===e?350:void 0}},{key:"axisType",value:function(e){return"ordinal"}},{key:"colorRange",value:function(e,t){for(var a=0;a<e.length;a++)if("individualStudent"===t&&0!==e[a].color||("weekly"===t||"annual"===t)&&0!==e[a].color)return["#F5FBFD","teal"];return["#F5FBFD","#F5FBFD"]}},{key:"reverseYAxis",value:function(e,t){if("individualStudent"===e)return this.state.yArrayStudents.map(function(e){return e}).reverse();try{return t.map(function(e){return e}).reverse()}catch(a){console.log(a)}}},{key:"calculateMinDataPoint",value:function(e){for(var t,a=0,n=0;n<e.length;n++)(t=e[n].color)&&t<a&&(a=t);return a}},{key:"calculateMaxDataPoint",value:function(e){for(var t,a=0,n=0;n<e.length;n++)(t=e[n].color)&&t>a&&(a=t);return a}},{key:"calculateHeatmapColor",value:function(e){return 0==e?"#F5FBFD":"teal"}},{key:"render",value:function(){var e=this.props.data,t=e.length,a=this.props.heatMapType,n=this.calculateMinDataPoint(e),i=this.calculateMaxDataPoint(e),r=this.calculateHeatmapColor(i),o=(this.colorRange(i),this.setYArrayRange(e));return s.a.createElement("div",null,s.a.createElement("div",{style:{margin:20}},s.a.createElement(ce.e,{width:this.scaleWidth(a,t),height:this.scaleHeight(a),margin:{top:30,left:45},xType:"ordinal",yType:this.axisType(a),yDomain:this.reverseYAxis(a,o)},s.a.createElement(ce.d,{orientation:"top"}),s.a.createElement(ce.f,{orientation:"left"}),s.a.createElement(ce.a,{className:"heatmap-series-example",colorRange:this.colorRange(e,a),data:e,style:{stroke:"black",strokeWidth:"1px",rectStyle:{rx:1,ry:1}}}))),s.a.createElement(de.a,{width:300,startTitle:n,midTitle:Math.round((i+n)/2),endTitle:i,startColor:"#F5FBFD",endColor:r,height:100}))}}]),t}(n.Component));he.defaultProps={data:[],heatMapType:""};var pe=he,me=a(210),fe=a(222),be=a(113),ve=a.n(be),ge=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).renderDisplayInfo=function(){var e=[],t=a.state.profileInfo;for(var n in t)if(!0===t[n].colInfo.is_showing){var i="N/A";null!==t[n].value&&null!=t[n].value!=""&&(i=t[n].value);var r=t[n].colInfo.name+": "+i;e.push(s.a.createElement(me.a,{key:n},r))}return e},a.renderEditInfo=function(){var e=[];for(var t in a.state.profileInfo){var n=a.state.profileInfo[t].colInfo.name+": ";if(a.state.profileInfo[t].colInfo.is_showing){e.push(s.a.createElement(Z.a,{key:t+"label"},n));var i=a.state.profileInfo[t].colInfo.type;e.push(s.a.createElement(C.a,{key:n,type:i,id:t,defaultValue:a.state.profileInfo[t].value,onChange:function(e){return a.handleInfoChange(e,a.state)}})),e.push(s.a.createElement("br",{key:t+"break"}))}}return e},a.state={mode:"search"},a.display=a.display.bind(Object(w.a)(Object(w.a)(a))),a.edit=a.edit.bind(Object(w.a)(Object(w.a)(a))),a.handler=a.handler.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a,n,s,i;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("https://".concat(U,"/api/students/"));case 3:return t=e.sent,a=this.makeSuggestionsArray(t),e.next=7,F("https://".concat(U,"/api/student_column/"));case 7:n=e.sent,s=this.parseCols(n),i=this.parseCols(n),this.setState(function(e,t){return{mode:"search",suggestionsArray:a,studentColumnJson:n,profileInfo:s,profileInfoPrelim:i,id:null,uploadedPic:!1}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}},e,this,[[0,13]])}));return function(){return e.apply(this,arguments)}}()},{key:"makeSuggestionsArray",value:function(e){var t,a,n,s=[];for(var i in e)e[i].last_name.includes(" ")?(t=(n=e[i].last_name.split(" "))[0],a=n[1]):(t=e[i].last_name,a=""),s.push({firstName:e[i].first_name,lastName1:t,lastName2:a,id:e[i].id});return s}},{key:"parseCols",value:function(e){e.sort(this.sortCols);var t=[];for(var a in e)t[a]={studentInfoId:null,colInfo:e[a],value:null,type:null,updated:!1,patchPost:{student_id:null,info_id:parseInt(a)+1,int_value:null,str_value:null,bool_value:null,date_value:null,time_value:null,id:null}};return t}},{key:"sortCols",value:function(e,t){return e.info_id>t.info_id?1:e.info_id<t.info_id?-1:0}},{key:"handler",value:function(e,t){var a={mode:"display",id:t,profileInfo:this.state.profileInfo,profileInfoPrelim:this.state.profileInfoPrelim};this.getStudentProfile(a)}},{key:"getStudentProfile",value:function(){var e=Object(M.a)(x.a.mark(function e(t){var a,n,s,i,r,o;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("https://".concat(U,"/api/students/?id=")+t.id);case 3:return a=e.sent,t.profileData=a,t.profileDataPrelim=JSON.parse(JSON.stringify(a)),e.prev=6,e.next=9,F("http://127.0.0.1:8000/api/student_info?student_id="+t.id);case 9:if(0!=(n=e.sent).length){e.next=19;break}return e.next=13,F("http://127.0.0.1:8000/api/student_column");case 13:s=e.sent,t.profileInfo=this.parseCols(s),t.profileInfoPrelim=this.parseCols(s),t=this.addTypes(t),e.next=28;break;case 19:return e.next=21,F("http://127.0.0.1:8000/api/student_column");case 21:s=e.sent,t.profileInfo=this.parseCols(s),t.profileInfoPrelim=this.parseCols(s),t=this.addTypes(t),i=this.parseStudentInfo(t,n),t.profileInfo=i.profileInfo,t.profileInfoPrelim=i.profileInfoPrelim;case 28:e.next=36;break;case 30:return e.prev=30,e.t0=e.catch(6),e.next=34,F("https://".concat(U,"/api/student_column/"));case 34:s=e.sent,t.profileInfo=this.parseCols(s);case 36:return Y(K(30)),"2018-01-28",t.startDateString="2018-01-28",r=K(0),q(r),"2018-03-03",t.endDateString="2018-03-03",e.next=46,F("https://".concat(U,"/api/reports/individualHeatmap/?student_id=")+t.id+"&startdate=2018-01-28&enddate=2018-03-03");case 46:o=e.sent,t.heatMapJson=o,this.setState(function(e,a){return t}),e.next=54;break;case 51:e.prev=51,e.t1=e.catch(0),console.log(e.t1);case 54:case"end":return e.stop()}},e,this,[[0,51],[6,30]])}));return function(t){return e.apply(this,arguments)}}()},{key:"updateStudentInfo",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F("https://".concat(U,"/api/student_info?student_id=")+this.state.id);case 2:t=e.sent,a=this.parseStudentInfo(this.state,t),this.setState(function(e,t){return{profileInfo:a.profileInfo,profileInfoPrelim:a.profileInfoPrelim}});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addTypes",value:function(e){for(var t in e.profileInfo){e.profileInfo[t].patchPost.student_id=e.id,e.profileInfoPrelim[t].patchPost.student_id=e.id,/varchar.*/g.test(e.profileInfo[t].colInfo.type)?(e.profileInfo[t].type="str_value",e.profileInfoPrelim[t].type="str_value"):(e.profileInfo[t].type=e.profileInfo[t].colInfo.type+"_value",e.profileInfoPrelim[t].type=e.profileInfo[t].colInfo.type+"_value")}return e}},{key:"parseStudentInfo",value:function(e,t){for(var a in e.profileInfo){var n;e.profileInfo[a].patchPost.student_id=e.id,e.profileInfoPrelim[a].patchPost.student_id=e.id,/varchar.*/g.test(e.profileInfo[a].colInfo.type)?(e.profileInfo[a].type="str_value",e.profileInfoPrelim[a].type="str_value"):(e.profileInfo[a].type=e.profileInfo[a].colInfo.type+"_value",e.profileInfoPrelim[a].type=e.profileInfo[a].colInfo.type+"_value")}for(var s in t){var i=t[s].info_id;e.profileInfo[i-1].patchPost=t[s],e.profileInfoPrelim[i-1].patchPost=t[s],e.profileInfo[i-1].studentInfoId=t[s].id,e.profileInfoPrelim[i-1].studentInfoId=t[s].id,n=e.profileInfo[i-1].type,e.profileInfo[i-1].value=t[s][n],e.profileInfoPrelim[i-1].value=t[s][n]}return e}},{key:"search",value:function(){var e={mode:"search",id:this.state.id,profileInfo:this.state.profileInfo,profileInfoPrelim:this.state.profileInfoPrelim};this.getStudentProfile(e)}},{key:"display",value:function(){var e={mode:"display",id:this.state.id,profileInfo:this.state.profileInfo,profileInfoPrelim:this.state.profileInfoPrelim};this.getStudentProfile(e)}},{key:"edit",value:function(){this.setState({mode:"edit"})}},{key:"delete",value:function(){var e=Object(M.a)(x.a.mark(function e(t,a){var n,s,i,r,o,l,c;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={mode:"search",id:this.state.id,profileInfo:this.state.profileInfo,profileInfoPrelim:this.state.profileInfoPrelim},e.prev=2,e.next=5,F("http://127.0.0.1:8000/api/student_info?student_id="+a.id);case 5:if(0!=(s=e.sent).length){e.next=14;break}return e.next=9,F("http://127.0.0.1:8000/api/student_column");case 9:i=e.sent,n.profileInfo=this.parseCols(i),n=this.addTypes(n),e.next=21;break;case 14:return e.next=16,F("http://127.0.0.1:8000/api/student_column");case 16:i=e.sent,n.profileInfo=this.parseCols(i),n=this.addTypes(n),r=this.parseStudentInfo(n,s),n.profileInfo=r.profileInfo;case 21:e.next=29;break;case 23:return e.prev=23,e.t0=e.catch(2),e.next=27,F("http://127.0.0.1:8000/api/student_column");case 27:i=e.sent,n.profileInfo=this.parseCols(i);case 29:for(o in R("http://127.0.0.1:8000/api/students/",a.profileData),n.profileInfo)(o=n.profileInfo[o]).studentInfoId?R("http://127.0.0.1:8000/api/student_info/?id="+o.studentInfoId,o.patchPost):console.log(o);for(l=!1,c=0;!1===l;)a.suggestionsArray[c].id===a.profileData.id?(a.suggestionsArray.splice(c,1),l=!0):c++;this.state.mode="search",this.setState(function(e,t){return a});case 36:case"end":return e.stop()}},e,this,[[2,23]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleNameChange",value:function(e,t){var a=e.target.id;t.profileDataPrelim[a]=e.target.value,t.profileDataUpdated=!0,this.setState(function(e,a){return t})}},{key:"handleInfoChange",value:function(e,t){var a=parseInt(e.target.id),n=e.target.value,s=t.profileInfoPrelim[a].type;t.profileInfoPrelim[a].updated=!0,""===n&&(n=null),t.profileInfoPrelim[a].value=n,t.profileInfoPrelim[a].patchPost[s]=n,this.setState(function(e,a){return t})}},{key:"handleSubmit",value:function(e,t){e.preventDefault(),t.profileInfo=JSON.parse(JSON.stringify(t.profileInfoPrelim)),t.profileDataUpdated&&(t.profileData=JSON.parse(JSON.stringify(t.profileDataPrelim)),P("http://".concat(U,"/api/students/"),t.profileData));var a=!1;for(var n in t.profileInfo){(n=t.profileInfo[n]).updated&&(n.studentInfoId?P("http://".concat(U,"/api/student_info/?id=")+n.studentInfoId,n.patchPost):(T("http://".concat(U,"/api/student_info/"),n.patchPost),a=!0))}a&&this.updateStudentInfo();for(var s=!1,i=0;!1===s;)t.suggestionsArray[i].id===t.profileData.id?(t.suggestionsArray[i]={firstName:t.profileData.first_name,id:t.profileData.id,lastName1:t.profileData.last_name,lastName2:""},s=!0):i++;t.id=t.profileData.id,t.mode="display",this.setState(function(e,a){return t})}},{key:"sameDay",value:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}},{key:"compareTime",value:function(e,t){return new Date(e)>new Date(t)}},{key:"formatData",value:function(e){e.id;var t,a=e.startDateString,n=e.endDateString,s=new Date(a.replace(/-/g,"/")),i=new Date(n.replace(/-/g,"/")),r=s,o=0,l=this.state.heatMapJson;if(0===l.length){var c={date:a,daily_visits:0};l.push(c)}for(;!1===this.compareTime(r,i);){if(o>l.length-1&&(o=l.length-1),t=new Date(l[o].date.replace(/-/g,"/")),!1===this.sameDay(r,t)){var u={date:r.toISOString().slice(0,10),daily_visits:0};o!==l.length-1||this.compareTime(t,r)?l.splice(o,0,u):l.splice(o+1,0,u)}r.setDate(r.getDate()+1),o++}for(var d,h,p,m,f=[],b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],v=0;v<l.length;v++)d=b[new Date(l[v].date.replace(/-/g,"/")).getDay()],h=Math.floor(v/7),(m=l[v].date.split(/\s*\-\s*/g))[0],m[1],m[2],p={x:d,y:(h+1).toString(),color:l[v].daily_visits},f.push(p);return f}},{key:"readImage",value:function(e,t){var a=this;e.preventDefault();var n=new FileReader;n.onloadend=function(){a.state.profileInfo[5].updated=!0,a.state.profileInfo[5].patchPost.blob_value=n.result,a.setState(function(e,t){return{src:n.result,uploadedPic:!0}})},n.readAsDataURL(e.target.files[0])}},{key:"render",value:function(){var e=this;return window.localStorage.getItem("permissions").split(",").indexOf("view_students")<0?s.a.createElement(D.a,{to:"/attendance"}):"search"===this.state.mode?s.a.createElement("div",{className:"content"},s.a.createElement("h1",null," Key Students "),s.a.createElement("div",{className:"container-fluid no-padding"},s.a.createElement("div",{className:"row justify-content-start"},s.a.createElement("div",{className:"col-md-12 to-front top-bottom-padding"},s.a.createElement(re,{suggestions:this.state.suggestionsArray,handler:this.handler}))))):"display"===this.state.mode?(this.state.uploadedPic?this.state.src:ve.a,s.a.createElement("div",{className:"content"},s.a.createElement("h1",null," Student Profile "),s.a.createElement("div",{className:"container-fluid no-padding"},s.a.createElement("div",{className:"row justify-content-start"},s.a.createElement("div",{className:"col-md-4 to-front top-bottom-padding"},s.a.createElement(re,{suggestions:this.state.suggestionsArray,handler:this.handler})))),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("div",{className:"container-fluid no-padding"},s.a.createElement("div",{className:"row justify-content-start"},s.a.createElement("div",{className:"col-md-2 to-front top-bottom-padding"},s.a.createElement(fe.a,null,s.a.createElement(me.a,null,"Name: ",this.state.profileData.first_name," ",this.state.profileData.last_name),this.renderDisplayInfo(this.state.parsedInfo)),s.a.createElement(j.a,{variant:"btn btn-primary",onClick:this.edit},"Edit")))),s.a.createElement("h3",null,"Student Attendance"),s.a.createElement("p",null,"Number of engagements for this individual student in the past month."),s.a.createElement(pe,{data:this.formatData(this.state),heatMapType:"individualStudent"}))):"edit"===this.state.mode?s.a.createElement("div",{className:"content"},s.a.createElement("h1",null," Student Profile "),s.a.createElement("div",{className:"container-fluid no-padding"},s.a.createElement("div",{className:"row justify-content-start"},s.a.createElement("div",{className:"col-md-4 to-front top-bottom-padding"},s.a.createElement(re,{suggestions:this.state.suggestionsArray,handler:this.handler})),s.a.createElement("div",{className:"col-md-8 top-bottom-padding"},s.a.createElement(se.a,{inline:!0,className:"col-md-8 top-bottom-padding",onSubmit:function(t){return e.handleSubmit(t,e.state)}},s.a.createElement(S.a,null,s.a.createElement(Z.a,null,"First Name: "),s.a.createElement(C.a,{type:"text",id:"first_name",defaultValue:this.state.profileData.first_name,onChange:function(t){return e.handleNameChange(t,e.state)}})," ",s.a.createElement("br",null),s.a.createElement(Z.a,null,"Last Name: "),s.a.createElement(C.a,{type:"text",id:"last_name",defaultValue:this.state.profileData.last_name,onChange:function(t){return e.handleNameChange(t,e.state)}})," ",s.a.createElement("br",null),this.renderEditInfo(this.state.parsedInfo),s.a.createElement("br",null),s.a.createElement(oe.a,null,s.a.createElement(j.a,{bsStyle:"default",onClick:this.display},"Cancel"),s.a.createElement(j.a,{bsStyle:"primary",type:"submit"},"Submit")),s.a.createElement("br",null),s.a.createElement(oe.a,null,s.a.createElement(j.a,{bsStyle:"danger",onClick:function(t){window.confirm("Are you sure you wish to delete this user?")&&e.delete(t,e.state)}},"Delete")))))))):void 0}}]),t}(n.Component),ye=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={data:e.data},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.data;return s.a.createElement(ce.e,{xType:"ordinal",width:400,height:350,yDomain:[0,350]},s.a.createElement(ce.d,null),s.a.createElement(ce.f,null),s.a.createElement(ce.c,{data:e}),s.a.createElement(ce.b,{data:e.map(function(e){return Object(G.a)({},e,{label:e.y.toString()})}),labelAnchorX:"middle",labelAnchorY:"text-after-edge"}))}}]),t}(s.a.Component);ye.defaultProps={data:[]};var ke=ye,we=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={startDateStringWeek:"",endDateStringWeek:"",startDateStringYear:"",endDateStringYear:"",byHourJson:[],byHourJsonForDownload:[],byDayJson:[],byDayJsonForDownload:[],byDayHeatMap:[]},a.downloadHourlyCSV=a.downloadHourlyCSV.bind(Object(w.a)(Object(w.a)(a))),a.downloadWeeklyCSV=a.downloadWeeklyCSV.bind(Object(w.a)(Object(w.a)(a))),a.downloadYearlyCSV=a.downloadYearlyCSV.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a,n,s,i,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="2018-02-08",a="2018-02-14",K(0),e.next=6,F("http://127.0.0.1:8000/api/reports/byHourAttendance/?startdate="+t+"&enddate="+a);case 6:return n=e.sent,console.log("By hour:",n),s="2018-02-04",i="2019-02-09",e.next=12,F("http://127.0.0.1:8000/api/reports/byDayAttendance/?startdate="+s+"&enddate="+i);case 12:return r=e.sent,e.next=15,this.formatDayData(r,s,i);case 15:return e.sent,e.next=18,this.formatHourData(n,t,a);case 18:e.sent,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0);case 24:case"end":return e.stop()}},e,this,[[0,21]])}));return function(){return e.apply(this,arguments)}}()},{key:"downloadHourlyCSV",value:function(){this.setState({buildingCSV:!0});var e="Reports_Hourly_Attendance_".concat(this.state.startDateStringWeek);e=(e=e.concat("_to_")).concat(this.state.endDateStringWeek),B(this.state.byHourJsonForDownload,["Date","Hour","# Engagements"],e),this.setState({buildingCSV:!1})}},{key:"downloadWeeklyCSV",value:function(){this.setState({buildingCSV:!0});var e="Reports_Daily_Attendance_".concat(this.state.startDateStringWeek);e=(e=e.concat("_to_")).concat(this.state.endDateStringWeek),B(this.state.byDayJsonForDownload.splice(0,7),["Date","# Engagements"],e),this.setState({buildingCSV:!1})}},{key:"downloadYearlyCSV",value:function(){this.setState({buildingCSV:!0});var e="Reports_Annual_Attendance_".concat(this.state.startDateStringYear);e=(e=e.concat("_to_")).concat(this.state.endDateStringYear),B(this.state.byDayJsonForDownload,["Date","# Engagements"],e),this.setState({buildingCSV:!1})}},{key:"sameDay",value:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}},{key:"compareTime",value:function(e,t){return new Date(e)>new Date(t)}},{key:"formatDayData",value:function(e,t,a){var n,s=t,i=a,r=new Date(s.replace(/-/g,"/")),o=new Date(i.replace(/-/g,"/")),l=r,c=0,u=e;if(0===u.length){var d={date:s,daily_visits:0};u.push(d)}for(;!1===this.compareTime(l,o);){if(c>u.length-1&&(c=u.length-1),n=new Date(u[c].date.replace(/-/g,"/")),!1===this.sameDay(l,n)){var h={date:l.toISOString().slice(0,10),daily_visits:0};c!==u.length-1||this.compareTime(n,l)?u.splice(c,0,h):u.splice(c+1,0,h)}l.setDate(l.getDate()+1),c++}for(var p,m=[],f=0;f<u.length;f++)p=Object.values(u[f]),m.push(p);var b,v,g,y,k,w=[],O=[],S=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];for(f=0;f<u.length;f++)y=S[new Date(u[f].date.replace(/-/g,"/")).getDay()],b=Math.floor(f/7),(k=u[f].date.split(/\s*\-\s*/g))[0],k[1],k[2],g={x:b+1,y:y,color:u[f].daily_visits},O.push(g),v={y:u[f].daily_visits,x:y},w.push(v);return this.setState(function(e,n){return{startDateStringYear:t,endDateStringYear:a,byDayJson:w,byDayJsonForDownload:m,byDayHeatMap:O}}),w}},{key:"formatHourData",value:function(e,t,a){var n,s,i=t,r=a,o=new Date(i.replace(/-/g,"/")),l=new Date(r.replace(/-/g,"/")),c=o,u=0,d=e,h=["14:00:00","15:00:00","16:00:00","17:00:00","18:00:00","19:00:00","20:00:00","21:00:00","22:00:00"];d=d.filter(function(e){return!0===h.includes(e.time)});var p=0,m=h[0];if(0===d.length){var f={date:i,time:h[0],count:0};d.push(f)}for(;!1===this.compareTime(c,l);){if(u>d.length-1&&(u=d.length-1),n=new Date(d[u].date.replace(/-/g,"/")),s=d[u].time,!1===this.sameDay(c,n)){var b={date:c.toISOString().slice(0,10),time:m,count:0};u!==d.length-1||this.compareTime(n,c)&&s>m?d.splice(u,0,b):d.splice(u+1,0,b)}else if(m!==s){b={date:c.toISOString().slice(0,10),time:m,count:0};u!==d.length-1||this.compareTime(n,c)&&s>m?d.splice(u,0,b):d.splice(u+1,0,b)}u++,m===h[h.length-1]&&(m="next day"),"next day"===m?(c.setDate(c.getDate()+1),m=h[0],p=0):m=h[++p]}for(var v,g=[],y=0;y<d.length;y++)v=Object.values(d[y]),g.push(v);var k,w,O,S,E=[],C=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];for(y=0;y<d.length;y++)k=C[new Date(d[y].date.replace(/-/g,"/")).getDay()],O=d[y].time.slice(0,2),(S=d[y].date.split(/\s*\-\s*/g))[0],S[1],S[2],w={x:O.concat(" hrs"),y:k,color:d[y].count},E.push(w);return this.setState(function(e,n){return{startDateStringWeek:t,endDateStringWeek:a,byHourJson:E,byHourJsonForDownload:g}}),E}},{key:"render",value:function(){var e=this.state.buildingCSV;return s.a.createElement("div",{className:"container py-4"},s.a.createElement("h1",null," Reports "),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-8 align-self-center"},s.a.createElement("h3",null," Hourly Attendance "),s.a.createElement("p",null," Number of engagements per hour in the past week."),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:this.downloadHourlyCSV,disabled:e},e?"Downloading...":"Download Hourly")),s.a.createElement(pe,{data:this.state.byHourJson,heatMapType:"weekly"})),s.a.createElement("div",{className:"col-md-4 align-self-center"},s.a.createElement("h3",null," Daily Attendance "),s.a.createElement("p",null," Number of engagements per day in the past week."),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:this.downloadWeeklyCSV,disabled:e},e?"Downloading...":"Download Daily")),s.a.createElement(ke,{data:this.state.byDayJson.slice(0,7)})," ")),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-8"},s.a.createElement("h3",null," Annual Daily Attendance "),s.a.createElement("p",null," Number of engagements per day in the past year."),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:this.downloadYearlyCSV,disabled:e},e?"Downloading...":"Download Annual")),s.a.createElement(pe,{data:this.state.byDayHeatMap,heatMapType:"annual"}))))}}]),t}(n.Component),Oe=a(223),Se=a(232),Ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(G.a)({},e);return a[t]=n,a})},a.handleActiveCheckbox=function(e){a.setState({is_active:!a.state.is_active})},a.state={username:"",first_name:"",last_name:"",password:"",confirmPassword:"",is_active:!0,error:!1,backendError:!1,radioOptions:[],show:!1,selectedOption:""},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.validateInput=a.validateInput.bind(Object(w.a)(Object(w.a)(a))),a.handleActiveCheckbox=a.handleActiveCheckbox.bind(Object(w.a)(Object(w.a)(a))),a.createRadioOptions=a.createRadioOptions.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.show!==this.state.show){var e=[],t=Object.keys(this.props.role_ids);for(var a in t)e.push({label:t[a],checked:!1});this.setState({radioOptions:e,show:this.props.show})}}},{key:"validateInput",value:function(){var e=this.state,t=e.username,a=e.password,n=e.confirmPassword;return t.length>0&&a.length>0&&a===n&&/^[a-z0-9.@+\-_]+$/i.test(t)&&this.state.selectedOption?"success":0===t.length&&0===a.length&&0===n.length?null:"error"}},{key:"cancel",value:function(){this.setState({username:"",first_name:"",last_name:"",password:"",confirmPassword:"",selectedOption:"",is_active:!0,error:!1,backendError:!1}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this;if(e.setState({backendError:!1}),"success"===e.validateInput()){e.setState({error:!1});var t=[];t.push(e.props.role_ids[e.state.selectedOption]);var a={username:e.state.username,password:e.state.password,first_name:e.state.first_name,last_name:e.state.last_name,groups:t,is_active:e.state.is_active};T("https://".concat(U,"/api/users/"),a).then(function(t){"error"in t?e.setState({backendError:!0}):(e.setState({username:"",first_name:"",last_name:"",password:"",confirmPassword:"",selectedOption:"",is_active:!0,error:!1,backendError:!1}),e.props.onSubmit(t))})}else e.setState({error:!0})}},{key:"toggleRadioOptions",value:function(e){var t=this.state.radioOptions,a="";if(!t[e].checked)for(var n in a=t[e].label,t)n!==e&&(t[n].checked=!1);t[e].checked=!t[e].checked,this.setState({selectedOption:a,radioOptions:t})}},{key:"createRadioOptions",value:function(){var e=this;return this.state.radioOptions.map(function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"userRoles",value:t.label,checked:t.checked,onChange:e.toggleRadioOptions.bind(e,a),className:"form-check-input"}),t.label))})}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New User")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(S.a,{validationState:this.validateInput()},s.a.createElement(E.a,null,"Username"),s.a.createElement(C.a,{type:"text",name:"username",value:this.state.username,placeholder:"Username",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"First Name"),s.a.createElement(C.a,{type:"text",name:"first_name",value:this.state.first_name,placeholder:"First Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Last Name"),s.a.createElement(C.a,{type:"text",name:"last_name",value:this.state.last_name,placeholder:"Last Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Password"),s.a.createElement(C.a,{type:"password",name:"password",value:this.state.password,placeholder:"Password",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Confirm Password"),s.a.createElement(C.a,{type:"password",name:"confirmPassword",value:this.state.confirmPassword||"",placeholder:"Confirm Password",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Active"),s.a.createElement(C.a,{type:"checkbox",checked:this.state.is_active,value:this.state.is_active,onChange:this.handleActiveCheckbox}),s.a.createElement(E.a,null,"User Roles"),this.createRadioOptions(),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},"Invalid input. Please check your fields and try again."),this.state.backendError&&s.a.createElement(_.a,{bsStyle:"danger"},"Server error. Please try again."),s.a.createElement(j.a,{onClick:this.cancel},"Cancel"),s.a.createElement(j.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),Ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(G.a)({},e);return a[t]=n,a})},a.handleActiveCheckbox=function(e){a.setState(function(e){var t=Object(G.a)({},e);return t.is_active=!a.state.is_active,t})},a.handlePasswordButton=function(e){a.setState({editPassword:!a.state.editPassword,password:"",confirmPassword:""})},a.state={row:{},show:!1,radioOptions:[],selectedOption:"",first_name:"",last_name:"",is_active:!0,password:"",confirmPassword:"",editPassword:!1,error:!1,backendError:!1},a.delete=a.delete.bind(Object(w.a)(Object(w.a)(a))),a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.handlePasswordButton=a.handlePasswordButton.bind(Object(w.a)(Object(w.a)(a))),a.handleActiveCheckbox=a.handleActiveCheckbox.bind(Object(w.a)(Object(w.a)(a))),a.validateInput=a.validateInput.bind(Object(w.a)(Object(w.a)(a))),a.createRadioOptions=a.createRadioOptions.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"validateInput",value:function(){var e=this.state,t=e.password,a=e.confirmPassword;return e.editPassword?0===t.length||t!==a?"error":"success":null}},{key:"componentDidUpdate",value:function(){if(this.props.row!==this.state.row&&this.setState({row:this.props.row}),this.props.show!==this.state.show){var e=[],t=Object.keys(this.props.row.role_ids),a=this.props.row.role_ids,n="";for(var s in t){var i=t[s],r=this.props.row.groups.indexOf(a[i])>-1;r&&(n=i),e.push({label:i,checked:r})}this.setState({radioOptions:e,selectedOption:n,show:this.props.show,first_name:this.props.row.first_name,last_name:this.props.row.last_name,is_active:this.props.row.is_active})}}},{key:"cancel",value:function(){this.setState({row:this.props.row,error:!1,backendError:!1,password:"",confirmPassword:"",editPassword:!1}),this.props.onSubmit()}},{key:"delete",value:function(){var e=this;R("https://".concat(U,"/api/users/?id=").concat(e.state.row.id)).then(function(t){"error"in t?e.setState({backendError:!0}):e.props.onDelete(e.state.row.id)})}},{key:"submit",value:function(){var e=this;if(this.setState({backendError:!1}),"error"!==e.validateInput()){this.setState({error:!1});var t={id:e.state.row.id,first_name:e.state.first_name,last_name:e.state.last_name,is_active:e.state.is_active},a=[];a.push(e.props.row.role_ids[e.state.selectedOption]),t.groups=a,""!==e.state.password&&(t.password=e.state.password),P("https://".concat(U,"/api/users/"),t).then(function(t){"error"in t?e.setState({backendError:!0}):(e.setState({password:"",confirmPassword:"",editPassword:!1}),e.props.onSubmit(t))})}else this.setState({error:!0})}},{key:"toggleRadioOptions",value:function(e){var t=this.state,a=t.radioOptions,n=t.selectedOption;if(!a[e].checked)for(var s in n=a[e].label,a)s!==e&&(a[s].checked=!1);a[e].checked=!a[e].checked,this.setState({selectedOption:n,radioOptions:a})}},{key:"createRadioOptions",value:function(){var e=this;return this.state.radioOptions.map(function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"userRoles",value:t.label,checked:t.checked,onChange:e.toggleRadioOptions.bind(e,a),className:"form-check-input"}),t.label))})}},{key:"render",value:function(){var e,t=this;return e=this.state.editPassword?s.a.createElement("div",null,s.a.createElement(E.a,null,"Password"),s.a.createElement(C.a,{type:"password",name:"password",value:this.state.password,placeholder:"Password",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Confirm Password"),s.a.createElement(C.a,{type:"password",name:"confirmPassword",value:this.state.confirmPassword,placeholder:"Confirm Password",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,{bsStyle:"warning",onClick:this.handlePasswordButton},"Discard Password Changes"),s.a.createElement("br",null)):s.a.createElement(j.a,{bsStyle:"link",onClick:this.handlePasswordButton},"Change Password"),s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Edit User")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(S.a,{validationState:this.validateInput()},s.a.createElement(E.a,null,"Username"),s.a.createElement("p",null,this.state.row.username),s.a.createElement("br",null),s.a.createElement(E.a,null,"First Name"),s.a.createElement(C.a,{type:"text",name:"first_name",value:this.state.first_name||"",placeholder:"First Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Last Name"),s.a.createElement(C.a,{type:"text",name:"last_name",value:this.state.last_name||"",placeholder:"Last Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Active"),s.a.createElement(C.a,{type:"checkbox",checked:this.state.is_active||!1,value:this.state.is_active,onChange:this.handleActiveCheckbox}),s.a.createElement("br",null),s.a.createElement(E.a,null,"User Role"),this.createRadioOptions(),e,s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},"Invalid password. Please make sure they match and try again."),this.state.backendError&&s.a.createElement(_.a,{bsStyle:"danger"},"Server error. Please try again."),s.a.createElement(j.a,{onClick:this.cancel},"Cancel"),s.a.createElement(j.a,{onClick:this.submit,bsStyle:"primary"},"Save"),s.a.createElement(j.a,{onClick:function(){window.confirm("Are you sure you wish to delete this user?")&&t.delete()},bsStyle:"danger"},"Delete")))}}]),t}(s.a.Component),je=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={row:{},showUserModal:!1},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModalDelete=a.closeModalDelete.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"openModal",value:function(){this.setState({showUserModal:!0})}},{key:"closeModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==t){e.props.CustomFunction(t)}this.setState({showUserModal:!1})}},{key:"closeModalDelete",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.setState({showUserModal:!1}),null!==t){e.props.CustomFunction(null,t)}}},{key:"componentDidUpdate",value:function(){this.props.row.id!==this.state.row.id&&this.setState({row:this.props.row})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(Ce,{show:this.state.showUserModal,row:this.props.row,onDelete:this.closeModalDelete,onSubmit:this.closeModal}),s.a.createElement(j.a,{bsStyle:"link",onClick:this.openModal},"Edit User"))}}]),t}(s.a.Component),_e=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={row:{}},a.handleClick=a.handleClick.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"componentDidUpdate",value:function(){this.props.row.id!==this.state.row.id&&this.setState({row:this.props.row})}},{key:"handleClick",value:function(){var e=this;e.props.CustomFunction(e.state.row.id,e.state.row.username)}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(j.a,{bsStyle:"link",onClick:this.handleClick},void 0===this.state.row.name||" "===this.state.row.name?"[User History]":this.state.row.name))}}]),t}(s.a.Component),De=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={history:[],username:""},a.closeHistoryView=a.closeHistoryView.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({history:this.props.history,username:this.props.username})}},{key:"closeHistoryView",value:function(){this.props.closeHistoryView()}},{key:"render",value:function(){var e=this.state.history.map(function(e){return{datetime:e.datetime,action:e.action,values:e.values}}).sort(function(e,t){return t.datetime.localeCompare(e.datetime)});return s.a.createElement("div",{className:"content"},s.a.createElement("h1",null,"User History: ",this.state.username),s.a.createElement("br",null),s.a.createElement(oe.a,{style:{float:"left"}},s.a.createElement(j.a,{bsStyle:"link",onClick:this.closeHistoryView},"Return to User Management")),s.a.createElement("br",null),s.a.createElement($.a,{rows:e,columns:[{accessor:"datetime",label:"Date/Time",priorityLevel:1,position:1,minWidth:100,sortable:!0},{accessor:"action",label:"Action",priorityLevel:2,position:2,minWidth:100,sortable:!0},{accessor:"values",label:"Values",priorityLevel:3,position:3,minWidth:100,sortable:!1}],column:"datetime",direction:"descending",showPagination:!0}))}}]),t}(s.a.Component),Ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={showUserModal:!1,users:[],showingUsers:[],role_ids:{},role_names:{},suggestionsArray:[],showingAllUsers:!0,selectedUserHistory:[],selectedUsername:"",historyView:!1},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.updateRow=a.updateRow.bind(Object(w.a)(Object(w.a)(a))),a.getFormattedTime=a.getFormattedTime.bind(Object(w.a)(Object(w.a)(a))),a.handler=a.handler.bind(Object(w.a)(Object(w.a)(a))),a.showAllUsers=a.showAllUsers.bind(Object(w.a)(Object(w.a)(a))),a.getUserHistory=a.getUserHistory.bind(Object(w.a)(Object(w.a)(a))),a.closeHistoryView=a.closeHistoryView.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a,n,s,i,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("https://".concat(U,"/api/users/"));case 3:return t=e.sent,a=this.makeSuggestionsArray(t),e.next=7,F("https://".concat(U,"/api/groups/"));case 7:for(r in n=e.sent,s={},i={},n)s[n[r].name]=n[r].id,i[n[r].id]=n[r].name;this.setState({showingUsers:t,users:t,role_ids:s,role_names:i,suggestionsArray:a}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a,n,s;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.refreshRoles){e.next=9;break}return e.next=3,F("https://".concat(U,"/api/groups/"));case 3:for(s in t=e.sent,a={},n={},t)a[t[s].name]=t[s].id,n[t[s].id]=t[s].name;this.setState({role_ids:a,role_names:n}),this.props.toggleRefreshRoles(!1);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"makeSuggestionsArray",value:function(e){var t,a,n,s=[];for(var i in e)e[i].last_name.includes(" ")?(t=(n=e[i].last_name.split(" "))[0],a=n[1]):(t=e[i].last_name,a=""),s.push({firstName:e[i].first_name,lastName1:t,lastName2:a,username:e[i].username,id:e[i].id});return s}},{key:"handler",value:function(e,t){var a=[];null!==t&&a.push(this.state.users.find(function(e){return e.id===parseInt(t)})),this.setState({showingUsers:a,showingAllUsers:!1})}},{key:"showAllUsers",value:function(){var e=this.state.users;this.setState({showingUsers:e,showingAllUsers:!0})}},{key:"openModal",value:function(){this.setState({showUserModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.users,a=[];if(null!==e){var n={id:e.id,username:e.username,first_name:e.first_name,last_name:e.last_name,groups:e.groups,last_login:e.last_login,is_active:e.is_active};t.push(n),a.push(n)}this.setState({showUserModal:!1,users:t,showingUsers:a,showingAllUsers:!1})}},{key:"checkmark",value:function(e){return e?"&#10003;":""}},{key:"getFormattedTime",value:function(e){if(null===e||0===e.length)return"";var t=e.split("T"),a=t[0],n=t[1].split(".")[0].split(":"),s=parseInt(n[0]),i=s>=12?"PM":"AM";return a+" "+(s=0===(s%=12)?12:s)+":"+n[1]+" "+i}},{key:"getUserRoleNames",value:function(e){var t=[];for(var a in e)t.push(this.state.role_names[e[a]]);return t.join(", ")}},{key:"updateRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.state.users,n=[],s=!1;if(null!==t)s=!0,n=a=a.filter(function(e){return e.id!==t});else{a=a.filter(function(t){return t.id!==e.id});var i={id:e.id,username:e.username,first_name:e.first_name,last_name:e.last_name,groups:e.groups,last_login:e.last_login,is_active:e.is_active};a.push(i),n.push(i)}this.setState({users:a}),this.setState({users:a,showingUsers:n,showingAllUsers:s})}},{key:"getUserHistory",value:function(e,t){var a=this;F("https://".concat(U,"/api/history/?user_id=").concat(e)).then(function(e){"error"in e?console.log(e):a.setState({selectedUserHistory:e,historyView:!0,selectedUsername:t})})}},{key:"closeHistoryView",value:function(){this.setState({historyView:!1})}},{key:"render",value:function(){var e=this,t=this.state.showingUsers.map(function(t){return{username:t.username,first_name:t.first_name,last_name:t.last_name,name:t.first_name+" "+t.last_name,roles:e.getUserRoleNames(t.groups),groups:t.groups,lastLogin:e.getFormattedTime(t.last_login),isActive:e.checkmark(t.is_active),id:t.id,is_active:t.is_active,role_ids:e.state.role_ids}}).sort(function(e,t){return e.username.localeCompare(t.username)}),a=[{accessor:"name",label:"Name",priorityLevel:1,position:1,CustomComponent:_e,minWidth:100,sortable:!0},{accessor:"username",label:"Username",priorityLevel:2,position:2,minWidth:100,sortable:!0},{accessor:"lastLogin",label:"Last Login",priorityLevel:3,position:3,minWidth:100,sortable:!0},{accessor:"roles",label:"User Roles",priorityLevel:4,position:4,sortable:!0,minWidth:30},{accessor:"isActive",label:"Active",priorityLevel:5,position:5,minWidth:20,sortable:!0},{accessor:"edit",label:"",priorityLevel:6,position:6,CustomComponent:je,minWidth:50,sortable:!1}],n={edit:this.updateRow,name:this.getUserHistory};return this.state.historyView?s.a.createElement(De,{closeHistoryView:this.closeHistoryView,history:this.state.selectedUserHistory,username:this.state.selectedUsername}):s.a.createElement("div",{className:"content"},s.a.createElement(Ee,{role_ids:this.state.role_ids,show:this.state.showUserModal,onSubmit:this.closeModal}),s.a.createElement("h1",null,"User Management"),s.a.createElement("br",null),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{className:this.state.showingAllUsers?"hidden":"",bsStyle:"link",onClick:this.showAllUsers},"Show All Users"),s.a.createElement(j.a,{onClick:this.openModal},"New User")),s.a.createElement(re,{hasUsername:!0,suggestions:this.state.suggestionsArray,handler:this.handler}),s.a.createElement("br",null),s.a.createElement($.a,{rows:t,columns:a,column:"username",direction:"descending",showPagination:!0,callbacks:n}))}}]),t}(s.a.Component),xe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(G.a)({},e);return a[t]=n,a})},a.state={show:!1,name:"",permission_ids:{},checkboxes:[]},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.createCheckboxes=a.createCheckboxes.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.show!==this.state.show){var e=[],t=this.props.permission_ids,a=Object.keys(t);for(var n in a){var s=a[n];e.push({label:s,checked:!1})}this.setState({permission_ids:this.props.permission_ids,checkboxes:e,show:this.props.show})}}},{key:"cancel",value:function(){this.setState({name:""}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this,t={name:e.state.name},a=[],n=e.state.checkboxes;for(var s in n)n[s].checked&&a.push(e.state.permission_ids[n[s].label]);t.permissions=a,T("https://".concat(U,"/api/groups/"),t).then(function(t){"error"in t?console.log(t):(e.setState({name:""}),e.props.onSubmit(t))})}},{key:"toggleCheckbox",value:function(e){var t=this.state.checkboxes;t[e].checked=!t[e].checked,this.setState({checkboxes:t})}},{key:"createCheckboxes",value:function(){var e=this;return this.state.checkboxes.map(function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:t.checked,onChange:e.toggleCheckbox.bind(e,a)}),t.label))})}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New User Role")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(S.a,null,s.a.createElement(E.a,null,"Role Name"),s.a.createElement(C.a,{type:"text",name:"name",value:this.state.name,placeholder:"Role Name",onChange:this.handleChange}),s.a.createElement("br",null),this.createCheckboxes(),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,s.a.createElement(j.a,{onClick:this.cancel},"Cancel"),s.a.createElement(j.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),Me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={show:!1,row:{},permission_ids:{},checkboxes:[]},a.delete=a.delete.bind(Object(w.a)(Object(w.a)(a))),a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.createCheckboxes=a.createCheckboxes.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.row!==this.state.row&&this.setState({row:this.props.row}),this.props.show!==this.state.show){var e=[],t=Object.keys(this.props.row.permission_ids),a=this.props.row.permission_ids;for(var n in t){var s=t[n],i=this.props.row.permissions.indexOf(a[s])>-1;e.push({label:s,checked:i})}this.setState({checkboxes:e,permission_ids:this.props.row.permission_ids,show:this.props.show})}}},{key:"delete",value:function(){var e=this;R("https://".concat(U,"/api/groups/?id=").concat(e.state.row.id)).then(function(t){"error"in t?e.setState({backendError:!0}):e.props.onDelete(e.state.row.id)})}},{key:"cancel",value:function(){this.setState({row:this.props.row}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this,t={name:e.state.row.name,id:e.state.row.id},a=[],n=e.state.checkboxes;for(var s in n)n[s].checked&&a.push(e.state.permission_ids[n[s].label]);t.permissions=a,P("https://".concat(U,"/api/groups/"),t).then(function(t){"error"in t?console.log(t):e.props.onSubmit(t)})}},{key:"toggleCheckbox",value:function(e){var t=this.state.checkboxes;t[e].checked=!t[e].checked,this.setState({checkboxes:t})}},{key:"createCheckboxes",value:function(){var e=this;return this.state.checkboxes.map(function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:t.checked,disabled:"Admin"===e.state.row.name,onChange:e.toggleCheckbox.bind(e,a)}),t.label))})}},{key:"render",value:function(){var e=this;return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Edit User Role")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(S.a,null,s.a.createElement(E.a,null,"User Role"),s.a.createElement("p",null,this.state.row.name),this.createCheckboxes(),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,s.a.createElement(j.a,{onClick:this.cancel},"Cancel"),s.a.createElement(j.a,{onClick:this.submit,bsStyle:"primary"},"Save"),s.a.createElement(j.a,{onClick:function(){window.confirm("Are you sure you wish to delete this role?")&&e.delete()},bsStyle:"danger",disabled:"Admin"===this.state.row.name},"Delete")))}}]),t}(s.a.Component),Ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={row:{},showModal:!1},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModalDelete=a.closeModalDelete.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.row;null!==e&&(this.props.row.permissions=e.permissions,t.permissions=e.permissions),this.setState({showModal:!1,row:t})}},{key:"closeModalDelete",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.setState({showModal:!1}),null!==t){e.props.CustomFunction(t)}}},{key:"componentDidUpdate",value:function(){this.props.row.id!==this.state.row.id&&this.setState({row:this.props.row})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(Me,{show:this.state.showModal,row:this.props.row,onDelete:this.closeModalDelete,onSubmit:this.closeModal}),s.a.createElement(j.a,{bsStyle:"link",onClick:this.openModal},"Edit User Role"))}}]),t}(s.a.Component),Ae=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={showModal:!1,roles:[],permissions_list:{},permission_ids:{}},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.deleteRole=a.deleteRole.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a,n,s;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("https://".concat(U,"/api/groups/"));case 3:return t=e.sent,e.next=6,F("https://".concat(U,"/api/permissions/"));case 6:for(s in a=e.sent,n={},a)n[a[s].name]=a[s].id;this.setState({roles:t,permissions_list:a,permission_ids:n}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.roles;null!==e&&(t.push({id:e.id,name:e.name,permissions:e.permissions}),this.props.toggleRefreshRoles(!0)),this.setState({showModal:!1,roles:t})}},{key:"deleteRole",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.roles;null!==e&&(t=t.filter(function(t){return t.id!==e}),this.props.toggleRefreshRoles(!0)),this.setState({roles:t})}},{key:"render",value:function(){var e=this,t=this.state.roles.map(function(t){return{name:t.name,permissions:t.permissions,id:t.id,permission_ids:e.state.permission_ids}}).sort(function(e,t){return e.name.localeCompare(t.name)}),a=[{accessor:"name",label:"Role",priorityLevel:1,position:1,minWidth:50,sortable:!0},{accessor:"edit",label:"",priorityLevel:2,position:5,CustomComponent:Ne,minWidth:50,sortable:!1}],n={edit:this.deleteRole};return s.a.createElement("div",{className:"content"},s.a.createElement("h1",null,"User Roles"),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:this.openModal},"New User Role")),s.a.createElement(xe,{permission_ids:this.state.permission_ids,show:this.state.showModal,onSubmit:this.closeModal}),s.a.createElement($.a,{rows:t,columns:a,column:"name",direction:"descending",showPagination:!0,callbacks:n}))}}]),t}(s.a.Component),Ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={oldID:0,student:{},suggestions:[],searchArray:[],match:""},a.onCancel=a.onCancel.bind(Object(w.a)(Object(w.a)(a))),a.onSubmit=a.onSubmit.bind(Object(w.a)(Object(w.a)(a))),a.setMatch=a.setMatch.bind(Object(w.a)(Object(w.a)(a))),a.buildSuggestionsArray=a.buildSuggestionsArray.bind(Object(w.a)(Object(w.a)(a))),a.setMatchFromSearch=a.setMatchFromSearch.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({oldID:this.props.studentID})}},{key:"componentDidUpdate",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a,n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.studentID===this.state.oldID||-1===this.props.studentID){e.next=9;break}return e.next=3,F("https://".concat(U,"/api/students/?id=").concat(this.props.studentID));case 3:return t=e.sent,e.next=6,F("https://".concat(U,"/api/suggestions/student/?id=").concat(this.props.studentID));case 6:a=e.sent,n=this.buildSuggestionsArray(),this.setState({student:t,suggestions:a,searchArray:n,oldID:this.props.studentID});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"buildSuggestionsArray",value:function(){var e=[],t=this.props.citySpanStudents;for(var a in this.props.citySpanStudents)e.push({firstName:t[a].first_name,lastName1:t[a].last_name,lastName2:"",id:t[a].student_key});return e}},{key:"setMatch",value:function(e){this.setState({match:e})}},{key:"setMatchFromSearch",value:function(e,t){this.setState({match:t})}},{key:"onCancel",value:function(){this.setState({student:{},match:"",suggestions:[]}),this.props.onClose()}},{key:"onSubmit",value:function(){P("https://".concat(U,"/api/students/"),{student_key:this.state.match,id:this.props.studentID}),this.setState({student:{},match:"",suggestions:[]}),this.props.onClose(this.props.studentID)}},{key:"render",value:function(){var e=this;return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Find Student Key Match: ",void 0!==this.state.student.first_name?this.state.student.first_name+" "+this.state.student.last_name:"")),s.a.createElement(ae.a.Body,null,s.a.createElement("h4",null,"Suggestions:"),3===this.state.suggestions.length&&s.a.createElement(fe.a,null,s.a.createElement(me.a,null,s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:function(){return e.setMatch(e.state.suggestions[0].match_key)},bsStyle:"primary"},"Select")),s.a.createElement("p",{style:{paddingTop:"4px"}},this.state.suggestions[0].match_name)),s.a.createElement(me.a,null,s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:function(){return e.setMatch(e.state.suggestions[1].match_key)},bsStyle:"primary"},"Select")),s.a.createElement("p",{style:{paddingTop:"4px"}},this.state.suggestions[1].match_name)),s.a.createElement(me.a,null,s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:function(){return e.setMatch(e.state.suggestions[2].match_key)},bsStyle:"primary"},"Select")),s.a.createElement("p",{style:{paddingTop:"4px"}},this.state.suggestions[2].match_name))),s.a.createElement("br",null),s.a.createElement("h4",null,"Search for match:"),s.a.createElement(re,{suggestions:this.state.searchArray,handler:this.setMatchFromSearch}),s.a.createElement("br",null),""!==this.state.match&&s.a.createElement("h4",null,"Selected student key: ",this.state.match)),s.a.createElement(ae.a.Footer,null,s.a.createElement(j.a,{onClick:this.onCancel},"Cancel"),s.a.createElement(j.a,{onClick:this.onSubmit,bsStyle:"primary"},"Save")))}}]),t}(s.a.Component),Te=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(j.a,{bsStyle:"link",onClick:function(){return e.props.CustomFunction(e.props.row.id)}},"Assign Student Key"))}}]),t}(s.a.Component),Pe=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).handleChange=function(t){var a=t.target.files[0];!e.props.extension||a.name.indexOf(e.props.extension)>=0?e.setState({file:a,error:""}):e.setState({error:"Invalid file type"})},e.state={file:void 0,error:""},e.submit=e.submit.bind(Object(w.a)(Object(w.a)(e))),e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"submit",value:function(){void 0!==this.state.file&&(this.props.upload(this.state.file),this.setState({file:void 0}))}},{key:"render",value:function(){return s.a.createElement(se.a,null,s.a.createElement(S.a,null,s.a.createElement(E.a,{style:{display:"inline-block"}},this.props.label)," ",s.a.createElement(O.a,{style:{display:"inline-block"}},s.a.createElement("input",{style:{display:"inline-block"},onChange:this.handleChange,placeholder:null,type:"file"}))," ",s.a.createElement(j.a,{style:{display:"inline-block"},onClick:this.submit},"Upload")),""!==this.state.error&&s.a.createElement(Z.a,{bsStyle:"danger"},"Error: ",this.state.error))}}]),t}(s.a.Component),Fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={unmatchedStudents:[],citySpanStudents:[],suggestions:[],showModal:!1,focusedStudent:-1},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.handleRowClick=a.handleRowClick.bind(Object(w.a)(Object(w.a)(a))),a.handleSearch=a.handleSearch.bind(Object(w.a)(Object(w.a)(a))),a.handleCSVUpload=a.handleCSVUpload.bind(Object(w.a)(Object(w.a)(a))),a.processCSV=a.processCSV.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t,a,n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("https://".concat(U,"/api/suggestions/unmatchedstudents/"));case 3:return t=e.sent,e.next=6,F("https://".concat(U,"/api/suggestions/cityspanstudents/"));case 6:a=e.sent,n=this.makeSuggestionsArray(t),this.setState({unmatchedStudents:t,suggestions:n,showModal:!1,focusedStudent:-1,citySpanStudents:a}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"handleCSVUpload",value:function(e){var t=this;a(70).parse(e,{error:this.tmpfail,fastMode:!0,complete:function(e,a){return t.processCSV(e)},header:!0})}},{key:"processCSV",value:function(e){var t=[];for(var a in e.data){var n=e.data[a];""!==n["Student Key"]&&null!==n["Student Key"]&&void 0!==n["Student Key"]&&t.push({first_name:n["First Name"],last_name:n["Last Name"],student_key:n["Student Key"]})}P("https://".concat(U,"/api/suggestions/cityspanstudents/"),{students:t})}},{key:"tmpfail",value:function(e,t){console.log(e)}},{key:"handleRowClick",value:function(e){this.setState({focusedStudent:e,showModal:!0})}},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"closeModal",value:function(e){for(var t=this.state.unmatchedStudents,a=0;a<t.length;a++)t[a].id===e&&t.splice(a,1);this.setState({showModal:!1,unmatchedStudents:t})}},{key:"handleSearch",value:function(e,t){this.setState({focusedStudent:t,showModal:!0})}},{key:"makeSuggestionsArray",value:function(e){var t,a,n,s=[];for(var i in e)e[i].last_name.includes(" ")?(t=(n=e[i].last_name.split(" "))[0],a=n[1]):(t=e[i].last_name,a=""),s.push({firstName:e[i].first_name,lastName1:t,lastName2:a,id:e[i].id});return s}},{key:"updateStudents",value:function(e){for(var t=this.state.unmatchedStudents,a=0;a<t.length;a++)t[a].id===e&&t.splice(a,1);this.setState({unmatchedStudents:t})}},{key:"render",value:function(){var e=this.state.unmatchedStudents.map(function(e){return{name:"".concat(e.first_name," ").concat(e.last_name),id:e.id}}).sort(function(e,t){return e.name.localeCompare(t.name)}),t=[{accessor:"name",label:"Name",priorityLevel:1,position:1,minWidth:50,sortable:!0},{accessor:"edit",label:"",priorityLevel:2,position:5,CustomComponent:Te,minWidth:50,sortable:!1}];return s.a.createElement("div",{className:"content"},s.a.createElement("h1",null,"Students Without Student Keys"),s.a.createElement(Ue,{show:this.state.showModal,studentID:this.state.focusedStudent,citySpanStudents:this.state.citySpanStudents,onClose:this.closeModal}),s.a.createElement("br",null),s.a.createElement("div",{style:{display:"inline-block"}},s.a.createElement(re,{suggestions:this.state.suggestions,handler:this.handleSearch})),s.a.createElement("div",{style:{float:"right"}},s.a.createElement(Pe,{extension:".csv",label:"Upload Cityspan Student CSV:",upload:this.handleCSVUpload})),s.a.createElement($.a,{rows:e,columns:t,column:"name",direction:"descending",showPagination:!0,callbacks:{edit:this.handleRowClick}}))}}]),t}(s.a.Component),Re=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={row:{}},a.handleButtonClick=a.handleButtonClick.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"handleButtonClick",value:function(){var e=this;e.props.CustomFunction(e.state.row.ordering,"down")}},{key:"componentDidUpdate",value:function(){this.props.row.activity_id!==this.state.row.activity_id&&this.setState({row:this.props.row})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(j.a,{onClick:this.handleButtonClick},"Shift Down"))}}]),t}(s.a.Component),We=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={row:{}},a.handleButtonClick=a.handleButtonClick.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"handleButtonClick",value:function(){var e=this;e.props.CustomFunction(e.state.row.ordering,"up")}},{key:"componentDidUpdate",value:function(){this.props.row.activity_id!==this.state.row.activity_id&&this.setState({row:this.props.row})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(j.a,{bsStyle:"primary",onClick:this.handleButtonClick},"Shift Up"))}}]),t}(s.a.Component),Le=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleCheckbox=function(){var e=Object(w.a)(Object(w.a)(a)),t={activity_id:e.state.row.activity_id,is_showing:!e.state.checked};P("https://".concat(U,"/api/activities/"),t).then(function(t){if("error"in t)console.log(t);else{e.props.CustomFunction(t)}})},a.state={row:{},checked:!1},a.toggleCheckbox=a.toggleCheckbox.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row,checked:this.props.row.is_showing})}},{key:"componentDidUpdate",value:function(){this.props.row.is_showing!==this.state.checked&&this.setState({checked:this.props.row.is_showing})}},{key:"render",value:function(){return s.a.createElement("span",{className:"checkbox"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:this.state.checked,onChange:this.toggleCheckbox})))}}]),t}(n.Component),He=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(G.a)({},e);return a[t]=n,a})},a.handleCheckbox=function(e){a.setState({inUse:!a.state.inUse})},a.state={show:!1,name:"",type:"boolean",inUse:!0,lastOrdering:0,error:!1,errorMsg:""},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.validateInput=a.validateInput.bind(Object(w.a)(Object(w.a)(a))),a.handleCheckbox=a.handleCheckbox.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){this.props.show!==this.state.show&&this.setState({show:this.props.show,lastOrdering:this.props.lastOrdering})}},{key:"validateInput",value:function(){var e=this.state.name;return e.length>0&&/^[a-z0-9.@+\-_]+$/i.test(e)&&this.state.type?"success":0===e.length?null:"error"}},{key:"cancel",value:function(){this.setState({name:"",type:"boolean",inUse:!0,lastOrdering:0,error:!1,errorMsg:""}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this;if("success"===e.validateInput()){var t={name:e.state.name,ordering:e.state.lastOrdering+1,is_showing:e.state.inUse,type:e.state.type};T("https://".concat(U,"/api/activities/"),t).then(function(t){if("error"in t){if(400===t.error){return void e.setState({error:!0,errorMsg:"Creation failed due to invalid input. Please check your fields and try again"})}}else e.setState({name:"",type:"boolean",inUse:!0,lastOrdering:0,error:!1,errorMsg:""}),e.props.onSubmit(t)})}else{e.setState({error:!0,errorMsg:"Invalid input. Please check your fields and try again."})}}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New Activity")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(S.a,{validationState:this.validateInput()},s.a.createElement(E.a,null,"Activity Name"),s.a.createElement(C.a,{type:"text",name:"name",value:this.state.name,placeholder:"Activity Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(C.a,{componentClass:"select",name:"type",onChange:this.handleChange,defaultValue:this.state.type},s.a.createElement("option",{value:"boolean"},"Checkbox"),s.a.createElement("option",{value:"string"},"Text"),s.a.createElement("option",{value:"float"},"Number")),s.a.createElement("br",null),s.a.createElement(E.a,null,"Currently in Use"),s.a.createElement(C.a,{type:"checkbox",checked:this.state.inUse,value:this.state.inUse,onChange:this.handleCheckbox}),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},this.state.errorMsg),s.a.createElement(j.a,{onClick:this.cancel},"Cancel"),s.a.createElement(j.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),Ve=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(G.a)({},e);return a[t]=n,a})},a.state={activities:[],showModal:!1},a.patchActivityOrder=a.patchActivityOrder.bind(Object(w.a)(Object(w.a)(a))),a.createNewActivity=a.createNewActivity.bind(Object(w.a)(Object(w.a)(a))),a.swapOrder=a.swapOrder.bind(Object(w.a)(Object(w.a)(a))),a.updateCheckbox=a.updateCheckbox.bind(Object(w.a)(Object(w.a)(a))),a.getDataTypeName=a.getDataTypeName.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("https://".concat(U,"/api/activities/"));case 3:t=e.sent,this.setState({activities:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"createNewActivity",value:function(e){return{activity_id:e.activity_id,type:e.type,ordering:e.ordering,is_showing:e.is_showing,name:e.name}}},{key:"patchActivityOrder",value:function(e,t){var a=this.state.activities,n=this,s={activity_id1:e,activity_id2:t};P("https://".concat(U,"/api/activities/"),s).then(function(e){if("error"in e[0]||"error"in e[1])console.log(e);else{var t=e[0],s=e[1];t&&s&&((a=(a=a.filter(function(e){return e.activity_id!==t.activity_id})).filter(function(e){return e.activity_id!==s.activity_id})).push(n.createNewActivity(t)),a.push(n.createNewActivity(s))),n.setState({activities:a})}})}},{key:"swapOrder",value:function(e,t){var a=this.state.activities;if(null!==e&&"up"===t&&e>1){var n=a.find(function(t){return t.ordering===e}),s=a.find(function(t){return t.ordering===e-1});this.patchActivityOrder(n.activity_id,s.activity_id)}else if(null!==e&&"down"===t&&e<a.length){var i=a.find(function(t){return t.ordering===e}),r=a.find(function(t){return t.ordering===e+1});this.patchActivityOrder(i.activity_id,r.activity_id)}}},{key:"updateCheckbox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.activities;null!==e&&(t=t.filter(function(t){return t.activity_id!==e.activity_id})).push(this.createNewActivity(e)),this.setState({activities:t})}},{key:"getDataTypeName",value:function(e){return"boolean"===e?"Checkbox":"string"===e?"Text":"float"===e?"Number":e}},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.activities;null!==e&&t.push(this.createNewActivity(e)),this.setState({showModal:!1,activities:t})}},{key:"render",value:function(){var e=this,t=this.state.activities.map(function(t){return{name:t.name,ordering:t.ordering,is_showing:t.is_showing,activity_id:t.activity_id,type:t.type,type_name:e.getDataTypeName(t.type)}}).sort(function(e,t){return e.ordering-t.ordering}),a=[{accessor:"name",label:"Activity",priorityLevel:1,position:1,minWidth:100,sortable:!1},{accessor:"type_name",label:"Data Type",priorityLevel:2,position:2,minWidth:100,sortable:!1},{accessor:"is_showing",label:"Currently in Use",priorityLevel:3,position:3,CustomComponent:Le,minWidth:50,sortable:!1},{accessor:"up",label:"",priorityLevel:4,position:4,CustomComponent:We,minWidth:100,sortable:!1},{accessor:"down",label:"",priorityLevel:5,position:5,CustomComponent:Re,minWidth:50,sortable:!1}],n={up:this.swapOrder,down:this.swapOrder,is_showing:this.updateCheckbox};return s.a.createElement("div",{className:"content"},s.a.createElement("h1",null,"Attendance Activities"),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:this.openModal},"New Activity")),s.a.createElement(He,{show:this.state.showModal,lastOrdering:this.state.activities.length,onSubmit:this.closeModal}),s.a.createElement($.a,{rows:t,columns:a,column:"name",direction:"descending",showPagination:!0,callbacks:n}))}}]),t}(s.a.Component),Be=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleCheckbox=function(){var e=Object(w.a)(Object(w.a)(a)),t={info_id:e.state.row.info_id};t[e.props.accessor]=!e.state.checked,P("https://".concat(U,"/api/student_column/"),t).then(function(t){if("error"in t)console.log(t);else{e.props.CustomFunction(t)}})},a.state={row:{},checked:!1},a.toggleCheckbox=a.toggleCheckbox.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){"is_showing"===this.props.accessor?this.setState({row:this.props.row,checked:this.props.row.is_showing}):"quick_add"===this.props.accessor&&this.setState({row:this.props.row,checked:this.props.row.quick_add})}},{key:"componentDidUpdate",value:function(){this.props.row.info_id!==this.state.row.info_id&&this.setState({row:this.props.row}),"is_showing"===this.props.accessor&&this.props.row.is_showing!==this.state.checked?this.setState({checked:this.props.row.is_showing}):"quick_add"===this.props.accessor&&this.props.row.quick_add!==this.state.checked&&this.setState({checked:this.props.row.quick_add})}},{key:"render",value:function(){return s.a.createElement("span",{className:"checkbox"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:this.state.checked,onChange:this.toggleCheckbox})))}}]),t}(n.Component),Je=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(G.a)({},e);return a[t]=n,a})},a.handleInUseCheckbox=function(e){a.setState({inUse:!a.state.inUse})},a.handleQuickAddCheckbox=function(e){a.setState({quickAdd:!a.state.quickAdd})},a.state={show:!1,name:"",type:"str",inUse:!0,quickAdd:!1,error:!1,errorMsg:""},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.validateInput=a.validateInput.bind(Object(w.a)(Object(w.a)(a))),a.handleInUseCheckbox=a.handleInUseCheckbox.bind(Object(w.a)(Object(w.a)(a))),a.handleQuickAddCheckbox=a.handleQuickAddCheckbox.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){this.props.show!==this.state.show&&this.setState({show:this.props.show})}},{key:"validateInput",value:function(){var e=this.state.name;return e.length>0&&/^[a-z0-9.@+\- _]+$/i.test(e)&&this.state.type?"success":0===e.length?null:"error"}},{key:"cancel",value:function(){this.setState({name:"",type:"str",inUse:!0,quickAdd:!1,error:!1,errorMsg:""}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this;if("success"===e.validateInput()){var t={name:e.state.name,is_showing:e.state.inUse,quick_add:e.state.quickAdd,type:e.state.type};T("https://".concat(U,"/api/student_column/"),t).then(function(t){if("error"in t){if(400===t.error){return void e.setState({error:!0,errorMsg:"Creation failed due to invalid input. Please check your fields and try again"})}}else e.setState({name:"",type:"str",inUse:!0,quickAdd:!1,error:!1,errorMsg:""}),e.props.onSubmit(t)})}else{e.setState({error:!0,errorMsg:"Invalid input. Please check your fields and try again."})}}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New Activity")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(S.a,{validationState:this.validateInput()},s.a.createElement(E.a,null,"Field Name"),s.a.createElement(C.a,{type:"text",name:"name",value:this.state.name,placeholder:"Field Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(C.a,{componentClass:"select",name:"type",onChange:this.handleChange,defaultValue:this.state.type},s.a.createElement("option",{value:"date"},"Date"),s.a.createElement("option",{value:"str"},"Text"),s.a.createElement("option",{value:"int"},"Number")),s.a.createElement("br",null),s.a.createElement(E.a,null,"Currently in Use"),s.a.createElement(C.a,{type:"checkbox",checked:this.state.inUse,value:this.state.inUse,onChange:this.handleInUseCheckbox}),s.a.createElement("br",null),s.a.createElement(E.a,null,"Show in Quick Add"),s.a.createElement(C.a,{type:"checkbox",checked:this.state.quickAdd,value:this.state.quickAdd,onChange:this.handleQuickAddCheckbox}),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},this.state.errorMsg),s.a.createElement(j.a,{onClick:this.cancel},"Cancel"),s.a.createElement(j.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),Ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(G.a)({},e);return a[t]=n,a})},a.state={fields:[],showModal:!1},a.createNewField=a.createNewField.bind(Object(w.a)(Object(w.a)(a))),a.updateCheckbox=a.updateCheckbox.bind(Object(w.a)(Object(w.a)(a))),a.getDataTypeName=a.getDataTypeName.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("https://".concat(U,"/api/student_column/"));case 3:t=e.sent,this.setState({fields:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"createNewField",value:function(e){return{info_id:e.info_id,is_showing:e.is_showing,quick_add:e.quick_add,name:e.name,type:e.type}}},{key:"updateCheckbox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.fields;null!==e&&(t=t.filter(function(t){return t.info_id!==e.info_id})).push(this.createNewField(e)),this.setState({fields:t})}},{key:"getDataTypeName",value:function(e){return"date"===e?"Date":"str"===e?"Text":"int"===e?"Number":e}},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.fields;null!==e&&t.push(this.createNewField(e)),this.setState({showModal:!1,fields:t})}},{key:"render",value:function(){var e=this,t=this.state.fields.map(function(t){return{name:t.name,is_showing:t.is_showing,info_id:t.info_id,type:t.type,type_name:e.getDataTypeName(t.type),quick_add:t.quick_add}}).sort(function(e,t){return e.name.localeCompare(t.name)}),a=[{accessor:"name",label:"Field",priorityLevel:1,position:1,minWidth:100,sortable:!1},{accessor:"type_name",label:"Data Type",priorityLevel:2,position:2,minWidth:100,sortable:!1},{accessor:"is_showing",label:"Currently in Use",priorityLevel:3,position:3,CustomComponent:Be,minWidth:50,sortable:!1},{accessor:"quick_add",label:"Show in Quick Add",priorityLevel:4,position:4,CustomComponent:Be,minWidth:50,sortable:!1}],n={is_showing:this.updateCheckbox,quick_add:this.updateCheckbox};return s.a.createElement("div",{className:"content"},s.a.createElement("h1",null,"Student Profile Fields"),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(j.a,{onClick:this.openModal},"New Student Profile Field")),s.a.createElement(Je,{show:this.state.showModal,onSubmit:this.closeModal}),s.a.createElement($.a,{rows:t,columns:a,column:"name",direction:"descending",showPagination:!0,callbacks:n}))}}]),t}(s.a.Component),Ye=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e,a))).handleSelect=n.handleSelect.bind(Object(w.a)(Object(w.a)(n))),n.toggleRefreshRoles=n.toggleRefreshRoles.bind(Object(w.a)(Object(w.a)(n))),n.state={refreshRoles:!1,key:1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleSelect",value:function(e){this.setState({key:e})}},{key:"toggleRefreshRoles",value:function(e){this.setState({refreshRoles:e})}},{key:"render",value:function(){return s.a.createElement(Oe.a,{activeKey:this.state.key,onSelect:this.handleSelect,id:"admin-tabs"},s.a.createElement(Se.a,{eventKey:1,title:"User Management"},s.a.createElement(Ie,{toggleRefreshRoles:this.toggleRefreshRoles,refreshRoles:this.state.refreshRoles})),s.a.createElement(Se.a,{eventKey:2,title:"User Roles"},s.a.createElement(Ae,{toggleRefreshRoles:this.toggleRefreshRoles})),s.a.createElement(Se.a,{eventKey:3,title:"Attendance Activities"},s.a.createElement(Ve,null)),s.a.createElement(Se.a,{eventKey:4,title:"Student Profile Fields"},s.a.createElement(Ke,null)),s.a.createElement(Se.a,{eventKey:5,title:"Student Key Management"},s.a.createElement(Fe,null)))}}]),t}(s.a.Component),qe=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=window.localStorage.getItem("permissions").split(",");return e.indexOf("view_user")>=0||e.indexOf("view_group")>=0?s.a.createElement("div",{className:"content"},s.a.createElement(Ye,null)):s.a.createElement(D.a,{to:"/attendance"})}}]),t}(s.a.Component),ze=a(225),Qe=a(224),$e=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"content"},s.a.createElement(Qe.a,null,s.a.createElement("div",{className:"content-jumbotron"},s.a.createElement("h1",null,"404 ",s.a.createElement("small",null,"page not found")),s.a.createElement("p",null,"The page you're looking for has mysteriously disappeared! Try navigating from ",s.a.createElement(ze.a,{to:"/attendance"},"the home page")," to take another look."))))}}]),t}(s.a.Component),Ge=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement(k,{show:"/"!==this.props.location.pathname},s.a.createElement(h.a,null,s.a.createElement(p.a,{exact:!0,path:"/",component:z}),s.a.createElement(p.a,{exact:!0,path:"/attendance",render:function(){return J(le)}}),s.a.createElement(p.a,{path:"/students",component:function(e){return J(ge)}})," ",s.a.createElement(p.a,{path:"/reports",render:function(){return J(we)}}),s.a.createElement(p.a,{path:"/admin",render:function(){return J(qe)}}),s.a.createElement(p.a,{render:function(){return J($e)}})))}}]),t}(s.a.Component),Xe=Object(m.a)(Ge),Ze=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(Xe,{history:A}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var et=a(230);r.a.render(s.a.createElement(et.a,null,s.a.createElement(Ze,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[116,2,1]]]);
//# sourceMappingURL=main.8eac38db.chunk.js.map