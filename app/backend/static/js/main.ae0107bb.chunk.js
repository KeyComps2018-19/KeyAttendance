(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,a){e.exports=a(207)},119:function(e,t,a){},195:function(e,t,a){},207:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),i=a(29),r=a.n(i),o=(a(119),a(9)),c=a(10),l=a(12),u=a(11),d=a(13),h=a(221),m=a(169),p=a(168),b=a(104),v=a(151),g=a(222),f=a(209),y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleItemClick=function(e){return function(){a.props.history.push("/".concat(e))}},a.logout=function(){return function(){window.localStorage.removeItem("key_credentials"),window.localStorage.removeItem("permissions"),a.props.history.push("/")}},a.state={activeItem:"home"},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(!this.props.show)return this.props.children;var e=window.localStorage.getItem("permissions").split(","),t=[];e.indexOf("view_attendanceitems")>=0&&t.push(s.a.createElement(b.a,{key:0,onClick:this.handleItemClick("attendance")},"Attendance")),e.indexOf("view_students")>=0&&t.push(s.a.createElement(b.a,{key:1,onClick:this.handleItemClick("students")},"Students")),(e.indexOf("view_group")>=0||e.indexOf("view_user")>=0)&&t.push(s.a.createElement(b.a,{key:2,onClick:this.handleItemClick("admin")},"Admin"));var a=s.a.createElement(v.a,null,t,s.a.createElement(b.a,{onClick:this.handleItemClick("reports")},"Reports"),s.a.createElement(b.a,{onClick:this.handleItemClick("alerts")},"Alerts"));return s.a.createElement("div",null,s.a.createElement(g.a,null,s.a.createElement(g.a.Header,null,s.a.createElement(g.a.Brand,{onClick:this.handleItemClick("attendance")},"Key"),s.a.createElement(g.a.Toggle,null)),s.a.createElement(g.a.Collapse,null,a,s.a.createElement(v.a,{pullRight:!0},s.a.createElement(b.a,{onClick:this.logout()},"Logout")))),this.props.children)}}]),t}(n.Component),k=Object(f.a)(y),w=a(2),O=a(210),E=a(211),j=a(212),C=a(224),S=a(213),_=a(214),D=a(226),x=a(18),N=a.n(x),M=a(24),I=a(110),A=a.n(I)()(),R="ec2-3-16-129-180.us-east-2.compute.amazonaws.com";function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=window.localStorage.getItem("key_credentials");if(null!==a)return fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"JWT "+a},body:JSON.stringify(t)}).then(function(e){return e.status>=400?(403===e.status&&(W(),A.push("/")),{error:e.status}):e.json()});A.push("/")}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=window.localStorage.getItem("key_credentials");if(null!==a)return fetch(e,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"JWT "+a},body:JSON.stringify(t)}).then(function(e){return e.status>=400?(403===e.status&&(W(),A.push("/")),{error:e.status}):e.json()});A.push("/")}function P(e){var t=window.localStorage.getItem("key_credentials");if(null!==t)return fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"JWT "+t}}).then(function(e){return e.status>=400?(403===e.status&&(W(),A.push("/")),{error:e.status}):e.json()});A.push("/")}function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=window.localStorage.getItem("key_credentials");if(null!==a)return fetch(e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"JWT "+a},body:JSON.stringify(t)}).then(function(e){return e.status>=400?(403===e.status&&(W(),A.push("/")),{error:e.status}):{}});A.push("/")}function F(e,t){return e.ordering<t.ordering?-1:e.ordering>t.ordering?1:0}function W(){window.localStorage.removeItem("key_credentials"),window.localStorage.removeItem("permissions")}function B(e){return J.apply(this,arguments)}function J(){return(J=Object(M.a)(N.a.mark(function e(t){var n,s,i,r,o,c,l,u,d,h,m,p,b,v,g,f,y,k=arguments;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=k.length>1&&void 0!==k[1]?k[1]:null,s=t===n||null===n?"http://".concat(R,"/api/attendance/?day=").concat(t):"http://".concat(R,"/api/attendance/?startdate=").concat(t,"&enddate=").concat(n),e.next=4,P(s);case 4:return i=e.sent,e.next=7,P("http://".concat(R,"/api/students/"));case 7:return r=e.sent,e.next=10,P("http://".concat(R,"/api/activities/"));case 10:if((o=e.sent).sort(F),0!==i.length&&0!==o.length){e.next=14;break}return e.abrupt("return");case 14:for(c={},l=0;l<o.length;l++)o[l].is_showing&&(c[o[l].name]={id:o[l].activity_id,ordering:o[l].ordering,type:o[l].type});for(u={},l=0;l<i.length;l++)null==u["".concat(i[l].student_id).concat(i[l].date)]&&(u["".concat(i[l].student_id).concat(i[l].date)]={date:i[l].date,id:i[l].student_id}),null!==i[l].str_value?u["".concat(i[l].student_id).concat(i[l].date)][i[l].activity_id]=i[l].str_value:null!==i[l].num_value?u["".concat(i[l].student_id).concat(i[l].date)][i[l].activity_id]=i[l].num_value:u["".concat(i[l].student_id).concat(i[l].date)][i[l].activity_id]="Y";for(d=[],h=["Date","First","Last","Student Key"],l=0;l<o.length;l++)o[l].is_showing&&h.push(o[l].name);m=Object.keys(u),l=0;case 23:if(!(l<m.length)){e.next=55;break}p=[],b=0;case 26:if(!(b<r.length)){e.next=34;break}if(r[b].id!==u[m[l]].id){e.next=31;break}return p[1]=r[b].first_name,p[2]=r[b].last_name,e.abrupt("break",34);case 31:b++,e.next=26;break;case 34:b=0;case 35:if(!(b<h.length)){e.next=51;break}e.t0=h[b],e.next="Date"===e.t0?39:"First"===e.t0?41:"Last"===e.t0?42:"Student Key"===e.t0?43:45;break;case 39:return p[b]=u[m[l]].date,e.abrupt("break",48);case 41:case 42:return e.abrupt("break",48);case 43:return p[b]="N/A",e.abrupt("break",48);case 45:v=c[h[b]],console.log(u[m[l]][v.id]),void 0===u[m[l]][v.id]?"boolean"===v.type?p[b]="N":p[b]="N/A":p[b]=u[m[l]][v.id];case 48:b++,e.next=35;break;case 51:d.push(p);case 52:l++,e.next=23;break;case 55:g=a(176),f=g.unparse({fields:h,data:d}),(y=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(f)),y.setAttribute("download","Attendance_".concat(t===n||null===n?t:"".concat(t,"_").concat(n),".csv")),y.style.display="none",document.body.appendChild(y),y.click(),document.body.removeChild(y);case 64:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var H=function(e){var t=window.localStorage.getItem("key_credentials"),a=function(e){var t=e.split(".");return JSON.parse(atob(t[1]))}(t);return null===t?s.a.createElement(D.a,{to:"/"}):a.exp<Date.now()/1e3?(W(),s.a.createElement(D.a,{to:"/"})):s.a.createElement(e,null)};function V(e){e<0&&(console.error("Expected daysAgo to be a value >= 0 but recieved ",e),e=-e);var t=new Date;return t.setDate(t.getDate()-e),t}function K(e){var t=e.getDay();return e.setDate(e.getDate()-t),e}function Y(e){var t=6-e.getDay();return e.setDate(e.getDate()+t),e}function z(e){return e.getFullYear().toString()+"-"+(e.getMonth()+1).toString()+"-"+e.getDate().toString()}var G=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={username:"",password:"",error:!1,firstLogin:!0},a.onUsernameChange=a.onUsernameChange.bind(Object(w.a)(Object(w.a)(a))),a.onPasswordChange=a.onPasswordChange.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){null!=localStorage.getItem("loggedIn")&&this.setState({firstLogin:!1})}},{key:"onUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"onPasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"submit",value:function(e){var t=this;e.preventDefault(),fetch("http://".concat(R,"/api-token-auth/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.state.username,password:this.state.password})}).then(function(e){e.status>=400?t.setState({error:!0,username:"",password:""}):e.json().then(function(e){window.localStorage.setItem("key_credentials",e.token),window.localStorage.setItem("permissions",e.permissions),window.localStorage.setItem("loggedIn","true"),t.props.history.push("/attendance")})})}},{key:"render",value:function(){var e=this,t={textAlign:"center"};return null!==window.localStorage.getItem("key_credentials")?s.a.createElement(D.a,{to:"/attendance"}):s.a.createElement("div",{className:"center"},s.a.createElement("div",{className:"login-container"},s.a.createElement(O.a,null,s.a.createElement("h2",{style:t},"Key Attendance"),s.a.createElement("h4",{style:t},"Sign In"),s.a.createElement("form",{onSubmit:function(t){return e.submit(t)}},s.a.createElement(E.a,null,s.a.createElement(j.a,null,"Username"),s.a.createElement(C.a,{type:"text",value:this.state.username,placeholder:"Username",onChange:this.onUsernameChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"Password"),s.a.createElement(C.a,{type:"password",value:this.state.password,placeholder:"Password",onChange:this.onPasswordChange})),s.a.createElement(S.a,{block:!0,type:"submit",bsStyle:"primary"},"Continue"),s.a.createElement("br",null),this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},"Invalid username or password. Please try again."),!this.state.firstLogin&&s.a.createElement(_.a,{bsStyle:"info"},"You have been logged out.")))))}}]),t}(s.a.Component),$=a(35),q=a.n($),Q=a(27),X=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={isChecked:!1,value:"",activityType:""},a.toggleCheckboxChange=function(){var e=a.props,t=e.toggleCheckbox,n=e.label;t(a.state.isChecked,n,a.state.value,a.state.activityType)},a.handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(Q.a)({},e);return a[t]=n,a})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({isChecked:this.props.checked,value:this.props.value,activityType:this.props.activityType})}},{key:"componentDidUpdate",value:function(){this.props.checked!==this.state.isChecked&&this.setState({isChecked:this.props.checked,value:this.props.value,activityType:this.props.activityType})}},{key:"render",value:function(){var e,t=this.props.label,a=this.state,n=a.isChecked,i=a.value,r=a.activityType,o=s.a.createElement("span",{className:"checkbox"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",value:t,checked:n,onChange:this.toggleCheckboxChange}),t));return"boolean"===r?s.a.createElement("span",{className:"checkbox"},o):(e="string"===r?s.a.createElement("input",{type:"text",value:i,name:"value",disabled:n,onChange:this.handleChange}):s.a.createElement("input",{type:"number",value:i,disabled:n,name:"value",onChange:this.handleChange}),s.a.createElement("span",{className:"checkbox"},o,e))}}]),t}(n.Component),Z=a(215),ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).toggleCheckbox=function(e,t,n,s){var i=a.state,r=i.activities,o=i.studentID,c=i.numChecked,l=i.date,u=Object(w.a)(Object(w.a)(a)),d=r[t].activityID,h=r[t].attendanceItemID;if(e)1===c||L("http://".concat(R,"/api/attendance/?key=").concat(h)).then(function(e){"error"in e?u.setState({error:e.error}):(r[t].value="boolean"!==s&&"",u.setState({activities:r,numChecked:c-1}))});else{var m=new Date,p={student_id:o,activity_id:d,date:"".concat(l),time:"".concat(m.getHours(),":").concat(m.getMinutes()>=10?m.getMinutes():"0".concat(m.getMinutes()),":").concat(m.getSeconds()>=10?m.getSeconds():"0".concat(m.getSeconds()))};if("string"===s){if(""===n)return;p.str_value=n}else if("float"===s){if(""===n)return;p.num_value=n}T("http://".concat(R,"/api/attendance/"),p).then(function(e){"error"in e?u.setState({error:e.error}):("boolean"===s?r[t].value=!0:"string"===s?r[t].value=e.str_value:"float"===s&&(r[t].value=e.num_value),r[t].attendanceItemID=e.id,u.setState({activities:r,numChecked:c+1}))})}},a.createCheckboxes=function(){for(var e=a.state.activities,t=Object.keys(e),n=[],i=0;i<t.length;i++){var r=e[t[i]].type,o=e[t[i]].value,c=void 0;c="boolean"===r?o:""!==o,n.push(s.a.createElement(X,{label:t[i],key:t[i],activityType:r,value:o,checked:c,toggleCheckbox:a.toggleCheckbox}))}return n},a.state={activities:{},studentID:0,error:"",numChecked:0,date:""},a.toggleCheckbox=a.toggleCheckbox.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){for(var e=0,t=this.props.row.activities,a=Object.keys(t),n=0;n<a.length;n++)"boolean"===t[a[n]].type?!0===t[a[n]].value&&e++:""!==t[a[n]].value&&e++;this.setState({activities:t,studentID:this.props.row.studentID,numChecked:e,date:this.props.row.date})}},{key:"render",value:function(){return s.a.createElement("span",{className:"container"},s.a.createElement("span",{className:"row"},s.a.createElement("span",{className:"col-sm-12"},this.state.numChecked<2&&s.a.createElement(Z.a,{bsStyle:"warning"},"At least one box must be checked"),""!==this.state.error&&s.a.createElement(Z.a,{bsStyle:"danger"},"Error ",this.state.error,": Your changes have not been saved. Please refresh and try again."),this.createCheckboxes())))}}]),t}(s.a.Component),te=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={row:{}},a.deleteRow=a.deleteRow.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"componentDidUpdate",value:function(){this.props.row.studentID!==this.state.row.studentID&&this.setState({row:this.props.row})}},{key:"deleteRow",value:function(){for(var e=this.state.row,t=e.activities,a=Object.keys(t),n=[],s=0;s<a.length;s++)0!==t[a[s]].attendanceItemID&&n.push(t[a[s]].attendanceItemID);for(var i=0;i<n.length;i++)L("http://".concat(R,"/api/attendance/?key=").concat(n[i]));this.props.CustomFunction(e.studentID)}},{key:"render",value:function(){return s.a.createElement(S.a,{bsStyle:"danger",onClick:this.deleteRow},"Delete")}}]),t}(s.a.Component),ae=a(223),ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={firstName:"",lastName:""},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.onFirstNameChange=a.onFirstNameChange.bind(Object(w.a)(Object(w.a)(a))),a.onLastNameChange=a.onLastNameChange.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"validateInput",value:function(){var e=this.state,t=e.firstName,a=e.lastName;return t.length>0&&a.length>0?"success":0===t.length&&0===a.length?null:"error"}},{key:"onFirstNameChange",value:function(e){this.setState({firstName:e.target.value})}},{key:"onLastNameChange",value:function(e){this.setState({lastName:e.target.value})}},{key:"cancel",value:function(){this.setState({firstName:"",lastName:""}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this;T("http://".concat(R,"/api/students/"),{first_name:this.state.firstName,last_name:this.state.lastName}).then(function(t){"error"in t?console.log(t):(e.setState({firstName:"",lastName:""}),e.props.onSubmit(t))})}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New Student")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(E.a,{controlId:"addStudentForm",validationState:this.validateInput()},s.a.createElement(j.a,null,"First Name"),s.a.createElement(C.a,{type:"text",value:this.state.firstName,placeholder:"First",onChange:this.onFirstNameChange}),s.a.createElement(C.a.Feedback,null),s.a.createElement("br",null),s.a.createElement(j.a,null,"Last Name"),s.a.createElement(C.a,{type:"text",value:this.state.lastName,placeholder:"Last",onChange:this.onLastNameChange}),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,s.a.createElement(S.a,{onClick:this.cancel},"Cancel"),s.a.createElement(S.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),se=(a(195),a(216)),ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=a.props.suggestions,n=e.currentTarget.value,s=t.filter(function(e){return!0===e.firstName.toLowerCase().startsWith(n.toLowerCase())||!0===e.lastName1.toLowerCase().startsWith(n.toLowerCase())||!0===e.lastName2.toLowerCase().startsWith(n.toLowerCase())||!0===e.id.toString().startsWith(n.toLowerCase())||!0===(e.firstName.toLowerCase()+" "+e.lastName1.toLowerCase()+" "+e.id.toString()).startsWith(n.toLowerCase())});a.setState({activeSuggestion:0,filteredSuggestions:s,showSuggestions:!0,userInput:e.currentTarget.value})},a.onClick=function(e){a.setState({activeSuggestion:0,filteredSuggestions:[],showSuggestions:!1,userInput:e.currentTarget.innerText}),a.props.handler(e,e._targetInst.key),a.setState({userInput:""})},a.handleSubmit=function(e){e.preventDefault()},a.onKeyDown=function(e){var t=a.state,n=t.activeSuggestion,s=t.filteredSuggestions;if(13===e.keyCode&&-1===a.state.activeSuggestion)a.props.handler(e,a.state.selectedId),a.setState({userInput:""});else if(13===e.keyCode){if("object"===typeof s[n]){var i=s[n].firstName+" "+s[n].lastName1;a.setState({activeSuggestion:-1,showSuggestions:!1,userInput:i,selectedId:s[n].id})}}else if(38===e.keyCode){if(0===n)return;a.setState({activeSuggestion:n-1}),a.scrollUpHandler()}else if(40===e.keyCode){if(n===s.length-1)return;a.setState({activeSuggestion:n+1}),a.scrollDownHandler()}},a.state={activeSuggestion:0,filteredSuggestions:[],showSuggestions:!1,userInput:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"scrollDownHandler",value:function(){var e=document.getElementsByClassName("suggestions"),t=document.getElementsByClassName("suggestion-active")[0].getBoundingClientRect().height,a=e[0].scrollTop,n=e[0].getBoundingClientRect().height,s=Math.round(Math.round(n/t)/2)*t;(this.state.activeSuggestion+2)*t>=a+n&&(e[0].scrollTop=e[0].scrollTop+s)}},{key:"scrollUpHandler",value:function(){var e=document.getElementsByClassName("suggestions"),t=document.getElementsByClassName("suggestion-active")[0].getBoundingClientRect().height,a=e[0].scrollTop,n=e[0].getBoundingClientRect().height,s=Math.round(Math.round(n/t)/2)*t;(this.state.activeSuggestion-1)*t<=a&&(e[0].scrollTop=e[0].scrollTop-s)}},{key:"render",value:function(){var e,t=this.onChange,a=this.onClick,i=this.onKeyDown,r=this.handleSubmit,o=this.state,c=o.activeSuggestion,l=o.filteredSuggestions,u=o.showSuggestions,d=o.userInput;return u&&d&&(e=l.length?s.a.createElement("div",{className:"suggestions"},l.map(function(e,t){var n;return t===c&&(n="suggestion-active"),s.a.createElement("p",{className:n,key:e.id,onClick:a},e.firstName," ",e.lastName1," ",e.lastName2)})):s.a.createElement("div",{className:"no-suggestions"},s.a.createElement("em",null,"No suggestions."))),s.a.createElement(n.Fragment,null,s.a.createElement(se.a,{inline:!0,onSubmit:r},s.a.createElement(E.a,{controlId:"formInlineName"},s.a.createElement(j.a,null,"Search:")," ",s.a.createElement(C.a,{autoComplete:"off",type:"text",value:d,onChange:t,onKeyDown:i,placeholder:"Name or ID"}),e)," "))}}]),t}(n.Component);ie.defaultProps={suggestions:[],handler:null};var re=ie,oe=a(217),ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={buildingCSV:!1,students:[],activities:[],attendanceItems:[],suggestionsArray:[],attendance:[],showStudentModal:!1,date:"",prevDate:""},a.downloadCSV=a.downloadCSV.bind(Object(w.a)(Object(w.a)(a))),a.addStudent=a.addStudent.bind(Object(w.a)(Object(w.a)(a))),a.removeAttendanceRow=a.removeAttendanceRow.bind(Object(w.a)(Object(w.a)(a))),a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.updateDate=a.updateDate.bind(Object(w.a)(Object(w.a)(a))),a.setDateToToday=a.setDateToToday.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({date:this.getCurrentDate()})}},{key:"componentDidUpdate",value:function(){this.state.date!==this.state.prevDate&&(this.setState({prevDate:this.state.date}),this.fetchAndBuild())}},{key:"getCurrentDate",value:function(){var e=new Date,t=e.getMonth()+1,a=e.getDate();return"".concat(e.getFullYear(),"-").concat(t>=10?t:"0".concat(t),"-").concat(a>=10?a:"0".concat(a))}},{key:"fetchAndBuild",value:function(){var e=Object(M.a)(N.a.mark(function e(){var t,a,n,s,i;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.date,e.prev=1,e.next=4,P("http://".concat(R,"/api/students/"));case 4:return a=e.sent,e.next=7,P("http://".concat(R,"/api/attendance/?day=").concat(t));case 7:return n=e.sent,e.next=10,P("http://".concat(R,"/api/activities/"));case 10:(s=(s=e.sent).filter(function(e){return!0===e.is_showing})).sort(F),i=this.makeSuggestionsArray(a),this.setState({suggestionsArray:i,students:a,activities:s,attendanceItems:n}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),console.log(e.t0);case 20:this.buildSheet();case 21:case"end":return e.stop()}},e,this,[[1,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"buildSheet",value:function(){for(var e=this.state,t=e.activities,a=e.attendanceItems,n=e.students,s={},i=0;i<a.length;i++)if(-1!==a[i].activity_id){null==s["".concat(a[i].student_id)]&&(s["".concat(a[i].student_id)]={time:a[i].time});var r=!0;null!==a[i].num_value?r=a[i].num_value:null!==a[i].str_value&&(r=a[i].str_value),s["".concat(a[i].student_id)][a[i].activity_id]={value:r,itemID:a[i].id}}var o=[],c=Object.keys(s),l=["Name"];for(i=0;i<t.length;i++)l.push(t[i].name);for(i=0;i<c.length;i++){for(var u={},d=0;d<n.length;d++)if(n[d].id===parseInt(c[i])){u.name="".concat(n[d].first_name," ").concat(n[d].last_name),u.studentID=n[d].id;break}u.time=s[c[i]].time,u.activities={};for(d=0;d<t.length;d++){var h=void 0;h=s[c[i]][t[d].activity_id]?s[c[i]][t[d].activity_id].value:"boolean"!==t[d].type&&"",u.activities[t[d].name]={value:h,activityID:t[d].activity_id,type:t[d].type,attendanceItemID:s[c[i]][t[d].activity_id]?s[c[i]][t[d].activity_id].itemID:0}}o.push(u)}this.setState({attendance:o})}},{key:"addStudent",value:function(e,t){for(var a=this.state,n=a.students,s=a.attendance,i=a.activities,r=a.date,o=new Date,c=this,l=0;l<s.length;l++)if(parseInt(t)===s[l].studentID)return;T("http://".concat(R,"/api/attendance/"),{student_id:t,activity_id:7,date:"".concat(r),time:"".concat(o.getHours(),":").concat(o.getMinutes()>=10?o.getMinutes():"0".concat(o.getMinutes()),":").concat(o.getSeconds()>=10?o.getSeconds():"0".concat(o.getSeconds()))}).then(function(e){for(var a="",r=0;r<n.length;r++)if(n[r].id===parseInt(t)){a="".concat(n[r].first_name," ").concat(n[r].last_name);break}var o={};for(r=0;r<i.length;r++){var l=i[r].type,u="boolean"!==l&&"";o[i[r].name]={activityID:i[r].activity_id,attendanceItemID:0,value:u,type:l}}o.Key.value=!0,o.Key.attendanceItemID=e.id;var d={name:a,studentID:parseInt(t),time:e.time,activities:o};s.push(d),c.setState({attendance:s})})}},{key:"makeSuggestionsArray",value:function(e){var t,a,n,s=[];for(var i in e)e[i].last_name.includes(" ")?(t=(n=e[i].last_name.split(" "))[0],a=n[1]):(t=e[i].last_name,a=""),s.push({firstName:e[i].first_name,lastName1:t,lastName2:a,id:e[i].id});return s}},{key:"downloadCSV",value:function(){var e=Object(M.a)(N.a.mark(function e(){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({buildingCSV:!0}),e.next=3,B("".concat(this.state.date));case 3:this.setState({buildingCSV:!1});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removeAttendanceRow",value:function(e){for(var t=this.state.attendance,a=0;a<t.length;a++)t[a].studentID===e&&t.splice(a,1);this.setState({attendance:t})}},{key:"openModal",value:function(){this.setState({showStudentModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.students,a=[];null!==e&&(t.push({first_name:e.first_name,last_name:e.last_name,id:e.id}),a=this.makeSuggestionsArray(t),this.addStudent(null,e.id)),this.setState({showStudentModal:!1,students:t,suggestions:a})}},{key:"updateDate",value:function(e){this.setState({date:e.target.value})}},{key:"setDateToToday",value:function(){new Date;this.setState({date:this.getCurrentDate()})}},{key:"render",value:function(){var e=this;if(window.localStorage.getItem("permissions").split(",").indexOf("view_attendanceitems")<0)return s.a.createElement(D.a,{to:"/attendance"});var t=this.state.attendance.map(function(t){return{name:t.name,time:t.time,activities:t.activities,studentID:t.studentID,date:e.state.date}}).sort(function(e,t){return t.time.localeCompare(e.time)}),a=[{accessor:"name",label:"Name",priorityLevel:1,position:1,minWidth:100,sortable:!0},{accessor:"time",label:"Check-in Time",priorityLevel:2,position:2,minWidth:100,sortable:!0},{accessor:"options",label:"Options",priorityLevel:3,position:3,CustomComponent:te,sortable:!1,minWidth:100},{accessor:"activities",label:"Activities",priorityLevel:4,position:4,minWidth:2e3,CustomComponent:ee,sortable:!1}],n=this.state.buildingCSV;return s.a.createElement("div",{className:"content"},s.a.createElement(ne,{show:this.state.showStudentModal,onSubmit:this.closeModal}),s.a.createElement("h1",null,"Attendance for ",this.state.date),s.a.createElement("br",null),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(S.a,{onClick:this.setDateToToday},"Go To Today"),s.a.createElement(S.a,{onClick:this.downloadCSV,disabled:n},n?"Downloading...":"Download"),s.a.createElement(S.a,{onClick:this.openModal},"New Student")),s.a.createElement(se.a,{inline:!0,style:{float:"right",paddingRight:"5px",paddingLeft:"5px"}},s.a.createElement(E.a,null,s.a.createElement(j.a,null,"Date:")," ",s.a.createElement(C.a,{onChange:this.updateDate,value:this.state.date,type:"date"}))),s.a.createElement(re,{suggestions:this.state.suggestionsArray,handler:this.addStudent}),s.a.createElement("br",null),s.a.createElement(q.a,{rows:t,columns:a,column:"time",direction:"descending",showPagination:!0,callbacks:{options:this.removeAttendanceRow}}))}}]),t}(s.a.Component),le=(a(21),a(45)),ue=(a(103),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={data:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(le.d,{width:500,height:300,margin:{top:30},xType:"ordinal"},s.a.createElement(le.c,{orientation:"top"}),s.a.createElement(le.e,{orientation:"left"}),s.a.createElement(le.b,{data:this.props.data}),s.a.createElement(le.a,{className:"heatmap-series-example",colorRange:["#fffaf0","orange"],data:this.props.data,style:{stroke:"black",strokeWidth:"1px",rectStyle:{rx:1,ry:1}}}))}}]),t}(n.Component)),de=a(84),he=a.n(de),me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={mode:"search",studentsJson:{},suggestionsArray:[],id:null,profileData:{},heatMapJson:{},startDateString:"",endDateString:""},a.edit=a.edit.bind(Object(w.a)(Object(w.a)(a))),a.handler=a.handler.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(N.a.mark(function e(){var t,a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P("http://".concat(R,"/api/students/"));case 3:t=e.sent,a=this.makeSuggestionsArray(t),this.setState(function(e,n){return{mode:"search",studentsJson:t,suggestionsArray:a,id:null,profileData:{},heatMapJson:{}}}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"makeSuggestionsArray",value:function(e){var t,a,n,s=[];for(var i in e)e[i].last_name.includes(" ")?(t=(n=e[i].last_name.split(" "))[0],a=n[1]):(t=e[i].last_name,a=""),s.push({firstName:e[i].first_name,lastName1:t,lastName2:a,id:e[i].id});return s}},{key:"handler",value:function(e,t){var a={mode:"display",id:t};this.getStudentProfile(a)}},{key:"getStudentProfile",value:function(){var e=Object(M.a)(N.a.mark(function e(t){var a,n,s,i,r,o,c;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P("http://".concat(R,"/api/students/?id=")+t.id);case 3:return a=e.sent,t.profileData=a,n=K(n=V(30)),s=z(n),t.startDateString=s,i=V(0),r=Y(i),o=z(r),t.endDateString=o,e.next=15,P("http://".concat(R,"/api/reports/individualHeatmap/?student_id=").concat(t.id,"&startdate=").concat(s,"&enddate=").concat(o));case 15:c=e.sent,console.log(c),t.heatMapJson=c,this.setState(function(e,a){return t}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0);case 24:case"end":return e.stop()}},e,this,[[0,21]])}));return function(t){return e.apply(this,arguments)}}()},{key:"edit",value:function(){this.setState({mode:"edit"})}},{key:"handleChange",value:function(e,t){var a=e.target.id;t.profileData[a]=e.target.value,this.setState(function(e,a){return t})}},{key:"handleSubmit",value:function(e,t){e.preventDefault(),U("http://".concat(R,"/api/students/"),t.profileData);for(var a=!1,n=0;!1===a;)t.suggestionsArray[n].id===t.profileData.id?(t.suggestionsArray[n]={firstName:t.profileData.first_name,id:t.profileData.id,lastName1:t.profileData.last_name,lastName2:""},a=!0):n++;t.id=t.profileData.id,t.mode="display",this.setState(function(e,a){return t})}},{key:"sameDay",value:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}},{key:"compareTime",value:function(e,t){return new Date(e)>new Date(t)}},{key:"formatData",value:function(e){e.id;var t,a=e.startDateString,n=e.endDateString,s=new Date(a.replace(/-/g,"/")),i=new Date(n.replace(/-/g,"/")),r=s,o=0,c=this.state.heatMapJson;if(0==c.length){var l={date:a,daily_visits:0};c.push(l)}for(;0==this.compareTime(r,i);){if(o>c.length-1&&(o=c.length-1),t=new Date(c[o].date.replace(/-/g,"/")),0==this.sameDay(r,t)){var u={date:r.toISOString().slice(0,10),daily_visits:0};o!=c.length-1||this.compareTime(t,r)?c.splice(o,0,u):c.splice(o+1,0,u)}r.setDate(r.getDate()+1),o++}for(var d,h,m,p,b=[],v=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g=0;g<c.length;g++)d=v[new Date(c[g].date.replace(/-/g,"/")).getDay()],h=Math.floor(g/7),(p=c[g].date.split(/\s*\-\s*/g))[0],p[1],p[2],m={x:d,y:h+1,color:c[g].daily_visits},b.push(m);return console.log("processed data: ",b),b}},{key:"render",value:function(){var e=this;return window.localStorage.getItem("permissions").split(",").indexOf("view_students")<0?s.a.createElement(D.a,{to:"/attendance"}):"search"===this.state.mode?s.a.createElement("div",{className:"content"},s.a.createElement("h1",null," Key Students "),s.a.createElement("div",{className:"container-fluid no-padding"},s.a.createElement("div",{className:"row justify-content-start"},s.a.createElement("div",{className:"col-md-12 to-front top-bottom-padding"},s.a.createElement(re,{suggestions:this.state.suggestionsArray,handler:this.handler}))))):"display"===this.state.mode?s.a.createElement("div",{className:"content"},s.a.createElement("h1",null," Student Profile "),s.a.createElement("div",{className:"container-fluid no-padding"},s.a.createElement("div",{className:"row justify-content-start"},s.a.createElement("div",{className:"col-md-4 to-front top-bottom-padding"},s.a.createElement(re,{suggestions:this.state.suggestionsArray,handler:this.handler})),s.a.createElement("div",{className:"col-md-8 top-bottom-padding"},s.a.createElement("img",{id:"studentPhoto",src:he.a,width:"196",height:"196"}),s.a.createElement("br",null),"Name: ",this.state.profileData.first_name," ",this.state.profileData.last_name," ",s.a.createElement("br",null),"Student ID: ",this.state.profileData.student_id," ",s.a.createElement("br",null),"Birthday: ",this.state.profileData.birthday," ",s.a.createElement("br",null),"Nickname: ",this.state.profileData.nickname," ",s.a.createElement("br",null),"Gender: ",this.state.profileData.gender," ",s.a.createElement("br",null),"First Attendance: ",this.state.profileData.first_attendance," ",s.a.createElement("br",null),"Number of Visits: ",this.state.profileData.number_visits," ",s.a.createElement("br",null),s.a.createElement("button",{onClick:this.edit},"Edit")))),s.a.createElement(ue,{data:this.formatData(this.state)})):"edit"===this.state.mode?s.a.createElement("div",{className:"content"},s.a.createElement("h1",null," Student Profile "),s.a.createElement("div",{className:"container-fluid no-padding"},s.a.createElement("div",{className:"row justify-content-start"},s.a.createElement("div",{className:"col-md-4 to-front top-bottom-padding"},s.a.createElement(re,{suggestions:this.state.suggestionsArray,handler:this.handler})),s.a.createElement("div",{className:"col-md-8 top-bottom-padding"},s.a.createElement("img",{id:"studentPhoto",src:he.a,width:"196",height:"196"}),s.a.createElement("p",null," Upload Student Profile Photo "),s.a.createElement("input",{id:"upload-button",type:"file",accept:"image/*",name:"file"}),s.a.createElement("br",null),s.a.createElement("form",{className:"col-md-8 top-bottom-padding",onSubmit:function(t){return e.handleSubmit(t,e.state)}},"First Name: ",s.a.createElement("input",{type:"text",id:"first_name",defaultValue:this.state.profileData.first_name,onChange:function(t){return e.handleChange(t,e.state)}})," ",s.a.createElement("br",null),"Last Name: ",s.a.createElement("input",{type:"text",id:"last_name",defaultValue:this.state.profileData.last_name,onChange:function(t){return e.handleChange(t,e.state)}})," ",s.a.createElement("br",null),"Student ID: ",s.a.createElement("input",{type:"text",id:"student_id",defaultValue:this.state.profileData.student_id,onChange:function(t){return e.handleChange(t,e.state)}})," ",s.a.createElement("br",null),"Birthday: ",s.a.createElement("input",{type:"date",id:"birthday",defaultValue:this.state.profileData.birthday,onChange:function(t){return e.handleChange(t,e.state)}})," ",s.a.createElement("br",null),"Nickname: ",s.a.createElement("input",{type:"text",id:"nickname",defaultValue:this.state.profileData.nickname,onChange:function(t){return e.handleChange(t,e.state)}})," ",s.a.createElement("br",null),"Gender: ",s.a.createElement("input",{type:"text",id:"gender",defaultValue:this.state.profileData.gender,onChange:function(t){return e.handleChange(t,e.state)}})," ",s.a.createElement("br",null),"First Attendance: ",s.a.createElement("input",{type:"date",id:"firstAttendance",defaultValue:this.state.profileData.first_attendance,onChange:function(t){return e.handleChange(t,e.state)}})," ",s.a.createElement("br",null),"Number of Visits: ",s.a.createElement("input",{type:"text",id:"numVisits",defaultValue:this.state.profileData.number_visits,onChange:function(t){return e.handleChange(t,e.state)}})," ",s.a.createElement("br",null),s.a.createElement("input",{type:"submit",value:"Submit"})))))):void 0}}]),t}(n.Component),pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={startDateStringWeek:"",endDateStringWeek:"",startDateStringYear:"",endDateStringYear:"",byHourJson:{},byDayJson:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(N.a.mark(function e(){var t,a,n,s,i,r,o,c,l,u,d,h;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=V(0),a=V(6),n=z(a),s=z(t),e.next=7,P("http://".concat(R,"/api/reports/byHourAttendance/?startdate=").concat(n,"&enddate=").concat(s));case 7:return i=e.sent,console.log("byHour: ",i),r=K(r=V(365)),o=z(r),c=Y(t),l=z(c),e.next=16,P("http://".concat(R,"/api/reports/byDayAttendance/?startdate=").concat(o,"&enddate=").concat(l));case 16:u=e.sent,console.log("byDay: ",u),this.setState(function(e,t){return{startDateStringWeek:n,endDateStringWeek:s,startDateStringYear:o,endDateStringYear:l,byHourJson:i,byDayJson:u}}),d=this.formatDayData(this.state),console.log("processed day of year data: ",d),h=this.formatHourData(this.state),console.log("processed hour of week data: ",h),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.log(e.t0);case 28:case"end":return e.stop()}},e,this,[[0,25]])}));return function(){return e.apply(this,arguments)}}()},{key:"sameDay",value:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}},{key:"compareTime",value:function(e,t){return new Date(e)>new Date(t)}},{key:"formatDayData",value:function(e){var t,a=e.startDateStringYear,n=e.endDateStringYear,s=new Date(a.replace(/-/g,"/")),i=new Date(n.replace(/-/g,"/")),r=s,o=0,c=this.state.byDayJson;if(console.log(c),0==c.length){var l={date:a,daily_visits:0};c.push(l)}for(;0==this.compareTime(r,i);){if(o>c.length-1&&(o=c.length-1),t=new Date(c[o].date.replace(/-/g,"/")),0==this.sameDay(r,t)){var u={date:r.toISOString().slice(0,10),daily_visits:0};o!=c.length-1||this.compareTime(t,r)?c.splice(o,0,u):c.splice(o+1,0,u)}r.setDate(r.getDate()+1),o++}for(var d,h,m,p,b=[],v=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g=0;g<c.length;g++)d=v[new Date(c[g].date.replace(/-/g,"/")).getDay()],h=Math.floor(g/7),(p=c[g].date.split(/\s*\-\s*/g))[0],p[1],p[2],m={x:h,y:d,color:c[g].daily_visits},b.push(m);return b}},{key:"formatHourData",value:function(e){var t,a,n=e.startDateStringWeek,s=e.endDateStringWeek,i=new Date(n.replace(/-/g,"/")),r=new Date(s.replace(/-/g,"/")),o=i,c=0,l=this.state.byHourJson,u=["14:00:00","15:00:00","16:00:00","17:00:00","18:00:00","19:00:00","20:00:00","21:00:00","22:00:00"];l=l.filter(function(e){return 1==u.includes(e.time)});var d=0,h=u[0];if(0==l.length){var m={date:n,time:u[0],count:0};l.push(m)}for(;0==this.compareTime(o,r);){if(c>l.length-1&&(c=l.length-1),t=new Date(l[c].date.replace(/-/g,"/")),a=l[c].time,0==this.sameDay(o,t)){var p={date:o.toISOString().slice(0,10),time:h,count:0};c!=l.length-1||this.compareTime(t,o)&&a>h?l.splice(c,0,p):l.splice(c+1,0,p)}else if(h!=a){p={date:o.toISOString().slice(0,10),time:h,count:0};c!=l.length-1||this.compareTime(t,o)&&a>h?l.splice(c,0,p):l.splice(c+1,0,p)}c++,h==u[u.length-1]&&(h="next day"),"next day"==h?(o.setDate(o.getDate()+1),h=u[0],d=0):h=u[++d]}for(var b,v,g,f,y=[],k=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],w=0;w<l.length;w++)b=k[new Date(l[w].date.replace(/-/g,"/")).getDay()],g=l[w].time,(f=l[w].date.split(/\s*\-\s*/g))[0],f[1],f[2],v={x:g,y:b,color:l[w].count},y.push(v);return y}},{key:"render",value:function(){return s.a.createElement("div",{className:"content"},s.a.createElement("p",null,"Reports"))}}]),t}(s.a.Component),be=a(218),ve=a(227),ge=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(Q.a)({},e);return a[t]=n,a})},a.handleActiveCheckbox=function(e){a.setState({is_active:!a.state.is_active})},a.state={username:"",first_name:"",last_name:"",password:"",confirmPassword:"",is_active:!0,error:!1,backendError:!1,radioOptions:[],show:!1,selectedOption:""},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.validateInput=a.validateInput.bind(Object(w.a)(Object(w.a)(a))),a.handleActiveCheckbox=a.handleActiveCheckbox.bind(Object(w.a)(Object(w.a)(a))),a.createRadioOptions=a.createRadioOptions.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.show!==this.state.show){var e=[],t=Object.keys(this.props.role_ids);for(var a in t)e.push({label:t[a],checked:!1});this.setState({radioOptions:e,show:this.props.show})}}},{key:"validateInput",value:function(){var e=this.state,t=e.username,a=e.password,n=e.confirmPassword;return t.length>0&&a.length>0&&a===n&&/^[a-z0-9.@+\-_]+$/i.test(t)&&this.state.selectedOption?"success":0===t.length&&0===a.length&&0===n.length?null:"error"}},{key:"cancel",value:function(){this.setState({username:"",first_name:"",last_name:"",password:"",confirmPassword:"",selectedOption:"",is_active:!0,error:!1,backendError:!1}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this;if(e.setState({backendError:!1}),"success"===e.validateInput()){e.setState({error:!1});var t=[];t.push(e.props.role_ids[e.state.selectedOption]);var a={username:e.state.username,password:e.state.password,first_name:e.state.first_name,last_name:e.state.last_name,groups:t,is_active:e.state.is_active};T("http://".concat(R,"/api/users/"),a).then(function(t){"error"in t?e.setState({backendError:!0}):(e.setState({username:"",first_name:"",last_name:"",password:"",confirmPassword:"",selectedOption:"",is_active:!0,error:!1,backendError:!1}),e.props.onSubmit(t))})}else e.setState({error:!0})}},{key:"toggleRadioOptions",value:function(e){var t=this.state.radioOptions,a="";if(!t[e].checked)for(var n in a=t[e].label,t)n!==e&&(t[n].checked=!1);t[e].checked=!t[e].checked,this.setState({selectedOption:a,radioOptions:t})}},{key:"createRadioOptions",value:function(){var e=this;return this.state.radioOptions.map(function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"userRoles",value:t.label,checked:t.checked,onChange:e.toggleRadioOptions.bind(e,a),className:"form-check-input"}),t.label))})}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New User")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(E.a,{validationState:this.validateInput()},s.a.createElement(j.a,null,"Username"),s.a.createElement(C.a,{type:"text",name:"username",value:this.state.username,placeholder:"Username",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"First Name"),s.a.createElement(C.a,{type:"text",name:"first_name",value:this.state.first_name,placeholder:"First Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"Last Name"),s.a.createElement(C.a,{type:"text",name:"last_name",value:this.state.last_name,placeholder:"Last Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"Password"),s.a.createElement(C.a,{type:"password",name:"password",value:this.state.password,placeholder:"Password",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"Confirm Password"),s.a.createElement(C.a,{type:"password",name:"confirmPassword",value:this.state.confirmPassword||"",placeholder:"Confirm Password",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"Active"),s.a.createElement(C.a,{type:"checkbox",checked:this.state.is_active,value:this.state.is_active,onChange:this.handleActiveCheckbox}),s.a.createElement(j.a,null,"User Roles"),this.createRadioOptions(),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},"Invalid input. Please check your fields and try again."),this.state.backendError&&s.a.createElement(_.a,{bsStyle:"danger"},"Server error. Please try again."),s.a.createElement(S.a,{onClick:this.cancel},"Cancel"),s.a.createElement(S.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(Q.a)({},e);return a[t]=n,a})},a.handleActiveCheckbox=function(e){a.setState(function(e){var t=Object(Q.a)({},e);return t.is_active=!a.state.is_active,t})},a.handlePasswordButton=function(e){a.setState({editPassword:!a.state.editPassword,password:"",confirmPassword:""})},a.state={row:{},show:!1,radioOptions:[],selectedOption:"",first_name:"",last_name:"",is_active:!0,password:"",confirmPassword:"",editPassword:!1,error:!1,backendError:!1},a.delete=a.delete.bind(Object(w.a)(Object(w.a)(a))),a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.handlePasswordButton=a.handlePasswordButton.bind(Object(w.a)(Object(w.a)(a))),a.handleActiveCheckbox=a.handleActiveCheckbox.bind(Object(w.a)(Object(w.a)(a))),a.validateInput=a.validateInput.bind(Object(w.a)(Object(w.a)(a))),a.createRadioOptions=a.createRadioOptions.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"validateInput",value:function(){var e=this.state,t=e.password,a=e.confirmPassword;return e.editPassword?0===t.length||t!==a?"error":"success":null}},{key:"componentDidUpdate",value:function(){if(this.props.row!==this.state.row&&this.setState({row:this.props.row}),this.props.show!==this.state.show){var e=[],t=Object.keys(this.props.row.role_ids),a=this.props.row.role_ids,n="";for(var s in t){var i=t[s],r=this.props.row.groups.indexOf(a[i])>-1;r&&(n=i),e.push({label:i,checked:r})}this.setState({radioOptions:e,selectedOption:n,show:this.props.show,first_name:this.props.row.first_name,last_name:this.props.row.last_name,is_active:this.props.row.is_active})}}},{key:"cancel",value:function(){this.setState({row:this.props.row}),this.props.onSubmit()}},{key:"delete",value:function(){var e=this;L("http://".concat(R,"/api/users/?id=").concat(e.state.row.id)).then(function(t){"error"in t?e.setState({backendError:!0}):e.props.onDelete(e.state.row.id)})}},{key:"submit",value:function(){var e=this;if(this.setState({backendError:!1}),"error"!==e.validateInput()){this.setState({error:!1});var t={id:e.state.row.id,first_name:e.state.first_name,last_name:e.state.last_name,is_active:e.state.is_active},a=[];a.push(e.props.row.role_ids[e.state.selectedOption]),t.groups=a,""!==e.state.password&&(t.password=e.state.password),U("http://".concat(R,"/api/users/"),t).then(function(t){"error"in t?e.setState({backendError:!0}):e.props.onSubmit(t)})}else this.setState({error:!0})}},{key:"toggleRadioOptions",value:function(e){var t=this.state.radioOptions,a="";if(!t[e].checked)for(var n in a=t[e].label,t)n!==e&&(t[n].checked=!1);t[e].checked=!t[e].checked,this.setState({selectedOption:a,radioOptions:t})}},{key:"createRadioOptions",value:function(){var e=this;return this.state.radioOptions.map(function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"userRoles",value:t.label,checked:t.checked,onChange:e.toggleRadioOptions.bind(e,a),className:"form-check-input"}),t.label))})}},{key:"render",value:function(){var e,t=this;return e=this.state.editPassword?s.a.createElement("div",null,s.a.createElement(j.a,null,"Password"),s.a.createElement(C.a,{type:"password",name:"password",value:this.state.password,placeholder:"Password",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"Confirm Password"),s.a.createElement(C.a,{type:"password",name:"confirmPassword",value:this.state.confirmPassword,placeholder:"Confirm Password",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(S.a,{bsStyle:"warning",onClick:this.handlePasswordButton},"Discard Password Changes"),s.a.createElement("br",null)):s.a.createElement(S.a,{bsStyle:"link",onClick:this.handlePasswordButton},"Change Password"),s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Edit User")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(E.a,{validationState:this.validateInput()},s.a.createElement(j.a,null,"Username"),s.a.createElement("p",null,this.state.row.username),s.a.createElement("br",null),s.a.createElement(j.a,null,"First Name"),s.a.createElement(C.a,{type:"text",name:"first_name",value:this.state.first_name||"",placeholder:"First Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"Last Name"),s.a.createElement(C.a,{type:"text",name:"last_name",value:this.state.last_name||"",placeholder:"Last Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(j.a,null,"Active"),s.a.createElement(C.a,{type:"checkbox",checked:this.state.is_active||!1,value:this.state.is_active,onChange:this.handleActiveCheckbox}),s.a.createElement("br",null),s.a.createElement(j.a,null,"User Role"),this.createRadioOptions(),e,s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},"Invalid password. Please make sure they match and try again."),this.state.backendError&&s.a.createElement(_.a,{bsStyle:"danger"},"Server error. Please try again."),s.a.createElement(S.a,{onClick:this.cancel},"Cancel"),s.a.createElement(S.a,{onClick:this.submit,bsStyle:"primary"},"Save"),s.a.createElement(S.a,{onClick:function(){window.confirm("Are you sure you wish to delete this user?")&&t.delete()},bsStyle:"danger"},"Delete")))}}]),t}(s.a.Component),ye=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={row:{},showUserModal:!1},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModalDelete=a.closeModalDelete.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"openModal",value:function(){this.setState({showUserModal:!0})}},{key:"closeModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==t){e.props.CustomFunction(t)}this.setState({showUserModal:!1})}},{key:"closeModalDelete",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.setState({showUserModal:!1}),null!==t){e.props.CustomFunction(null,t)}}},{key:"componentDidUpdate",value:function(){this.props.row.id!==this.state.row.id&&this.setState({row:this.props.row})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(fe,{show:this.state.showUserModal,row:this.props.row,onDelete:this.closeModalDelete,onSubmit:this.closeModal}),s.a.createElement(S.a,{bsStyle:"link",onClick:this.openModal},"Edit User"))}}]),t}(s.a.Component),ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showUserModal:!1,users:[],role_ids:{},role_names:{}},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.updateRow=a.updateRow.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(N.a.mark(function e(){var t,a,n,s,i;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P("http://".concat(R,"/api/users/"));case 3:return t=e.sent,e.next=6,P("http://".concat(R,"/api/groups/"));case 6:for(i in a=e.sent,n={},s={},a)n[a[i].name]=a[i].id,s[a[i].id]=a[i].name;this.setState({users:t,role_ids:n,role_names:s}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}},e,this,[[0,13]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(M.a)(N.a.mark(function e(){var t,a,n,s;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.refreshRoles){e.next=9;break}return e.next=3,P("http://".concat(R,"/api/groups/"));case 3:for(s in t=e.sent,a={},n={},t)a[t[s].name]=t[s].id,n[t[s].id]=t[s].name;this.setState({role_ids:a,role_names:n}),this.props.toggleRefreshRoles(!1);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"openModal",value:function(){this.setState({showUserModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.users;null!==e&&t.push({id:e.id,username:e.username,first_name:e.first_name,last_name:e.last_name,groups:e.groups,last_login:e.last_login,is_active:e.is_active}),this.setState({showUserModal:!1,users:t})}},{key:"checkmark",value:function(e){return e?"&#10003;":""}},{key:"getFormattedTime",value:function(e){if(null===e||0===e.length)return"";var t=e.split("T"),a=t[0],n=t[1].split(".")[0].split(":"),s=parseInt(n[0]),i=s>=12?"PM":"AM";return a+" "+(s=0===(s%=12)?12:s)+":"+n[1]+" "+i}},{key:"getUserRoleNames",value:function(e){var t=[];for(var a in e)t.push(this.state.role_names[e[a]]);return t.join(", ")}},{key:"updateRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.state.users;null!==t?a=a.filter(function(e){return e.id!==t}):(a=a.filter(function(t){return t.id!==e.id})).push({id:e.id,username:e.username,first_name:e.first_name,last_name:e.last_name,groups:e.groups,last_login:e.last_login,is_active:e.is_active}),this.setState({users:a})}},{key:"render",value:function(){var e=this,t=this.state.users.map(function(t){return{username:t.username,first_name:t.first_name,last_name:t.last_name,name:t.first_name+" "+t.last_name,roles:e.getUserRoleNames(t.groups),groups:t.groups,lastLogin:e.getFormattedTime(t.last_login),isActive:e.checkmark(t.is_active),id:t.id,is_active:t.is_active,role_ids:e.state.role_ids}}).sort(function(e,t){return e.username.localeCompare(t.username)}),a=[{accessor:"username",label:"Username",priorityLevel:1,position:1,minWidth:100,sortable:!0},{accessor:"name",label:"Name",priorityLevel:2,position:2,minWidth:100,sortable:!0},{accessor:"lastLogin",label:"Last Login",priorityLevel:3,position:3,minWidth:100,sortable:!0},{accessor:"roles",label:"User Roles",priorityLevel:4,position:4,sortable:!0,minWidth:30},{accessor:"isActive",label:"Active",priorityLevel:5,position:5,minWidth:20,sortable:!0},{accessor:"edit",label:"",priorityLevel:6,position:6,CustomComponent:ye,minWidth:50,sortable:!1}],n={edit:this.updateRow};return s.a.createElement("div",{className:"content"},s.a.createElement("h1",null,"User Management"),s.a.createElement("br",null),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(S.a,{onClick:this.openModal},"New User")),s.a.createElement(ge,{role_ids:this.state.role_ids,show:this.state.showUserModal,onSubmit:this.closeModal}),s.a.createElement(q.a,{rows:t,columns:a,column:"username",direction:"descending",showPagination:!0,callbacks:n}))}}]),t}(s.a.Component),we=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(Q.a)({},e);return a[t]=n,a})},a.state={show:!1,name:"",permission_ids:{},checkboxes:[]},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.createCheckboxes=a.createCheckboxes.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.show!==this.state.show){var e=[],t=this.props.permission_ids,a=Object.keys(t);for(var n in a){var s=a[n];e.push({label:s,checked:!1})}this.setState({permission_ids:this.props.permission_ids,checkboxes:e,show:this.props.show})}}},{key:"cancel",value:function(){this.setState({name:""}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this,t={name:e.state.name},a=[],n=e.state.checkboxes;for(var s in n)n[s].checked&&a.push(e.state.permission_ids[n[s].label]);t.permissions=a,T("http://".concat(R,"/api/groups/"),t).then(function(t){"error"in t?console.log(t):(e.setState({name:""}),e.props.onSubmit(t))})}},{key:"toggleCheckbox",value:function(e){var t=this.state.checkboxes;t[e].checked=!t[e].checked,this.setState({checkboxes:t})}},{key:"createCheckboxes",value:function(){var e=this;return this.state.checkboxes.map(function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:t.checked,onChange:e.toggleCheckbox.bind(e,a)}),t.label))})}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New User Role")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(E.a,null,s.a.createElement(j.a,null,"Role Name"),s.a.createElement(C.a,{type:"text",name:"name",value:this.state.name,placeholder:"Role Name",onChange:this.handleChange}),s.a.createElement("br",null),this.createCheckboxes(),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,s.a.createElement(S.a,{onClick:this.cancel},"Cancel"),s.a.createElement(S.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),Oe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={show:!1,row:{},permission_ids:{},checkboxes:[]},a.delete=a.delete.bind(Object(w.a)(Object(w.a)(a))),a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.createCheckboxes=a.createCheckboxes.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.row!==this.state.row&&this.setState({row:this.props.row}),this.props.show!==this.state.show){var e=[],t=Object.keys(this.props.row.permission_ids),a=this.props.row.permission_ids;for(var n in t){var s=t[n],i=this.props.row.permissions.indexOf(a[s])>-1;e.push({label:s,checked:i})}this.setState({checkboxes:e,permission_ids:this.props.row.permission_ids,show:this.props.show})}}},{key:"delete",value:function(){var e=this;L("http://".concat(R,"/api/groups/?id=").concat(e.state.row.id)).then(function(t){"error"in t?e.setState({backendError:!0}):e.props.onDelete(e.state.row.id)})}},{key:"cancel",value:function(){this.setState({row:this.props.row}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this,t={name:e.state.row.name,id:e.state.row.id},a=[],n=e.state.checkboxes;for(var s in n)n[s].checked&&a.push(e.state.permission_ids[n[s].label]);t.permissions=a,U("http://".concat(R,"/api/groups/"),t).then(function(t){"error"in t?console.log(t):e.props.onSubmit(t)})}},{key:"toggleCheckbox",value:function(e){var t=this.state.checkboxes;t[e].checked=!t[e].checked,this.setState({checkboxes:t})}},{key:"createCheckboxes",value:function(){var e=this;return this.state.checkboxes.map(function(t,a){return s.a.createElement("div",{key:a},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:t.checked,disabled:"Admin"===e.state.row.name,onChange:e.toggleCheckbox.bind(e,a)}),t.label))})}},{key:"render",value:function(){var e=this;return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Edit User Role")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(E.a,null,s.a.createElement(j.a,null,"User Role"),s.a.createElement("p",null,this.state.row.name),this.createCheckboxes(),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,s.a.createElement(S.a,{onClick:this.cancel},"Cancel"),s.a.createElement(S.a,{onClick:this.submit,bsStyle:"primary"},"Save"),s.a.createElement(S.a,{onClick:function(){window.confirm("Are you sure you wish to delete this role?")&&e.delete()},bsStyle:"danger",disabled:"Admin"===this.state.row.name},"Delete")))}}]),t}(s.a.Component),Ee=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={row:{},showModal:!1},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModalDelete=a.closeModalDelete.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.row;null!==e&&(this.props.row.permissions=e.permissions,t.permissions=e.permissions),this.setState({showModal:!1,row:t})}},{key:"closeModalDelete",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.setState({showModal:!1}),null!==t){e.props.CustomFunction(t)}}},{key:"componentDidUpdate",value:function(){this.props.row.id!==this.state.row.id&&this.setState({row:this.props.row})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(Oe,{show:this.state.showModal,row:this.props.row,onDelete:this.closeModalDelete,onSubmit:this.closeModal}),s.a.createElement(S.a,{bsStyle:"link",onClick:this.openModal},"Edit User Role"))}}]),t}(s.a.Component),je=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={showModal:!1,roles:[],permissions_list:{},permission_ids:{}},a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a.deleteRole=a.deleteRole.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(N.a.mark(function e(){var t,a,n,s;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P("http://".concat(R,"/api/groups/"));case 3:return t=e.sent,e.next=6,P("http://".concat(R,"/api/permissions/"));case 6:for(s in a=e.sent,n={},a)n[a[s].name]=a[s].id;this.setState({roles:t,permissions_list:a,permission_ids:n}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.roles;null!==e&&(t.push({id:e.id,name:e.name,permissions:e.permissions}),this.props.toggleRefreshRoles(!0)),this.setState({showModal:!1,roles:t})}},{key:"deleteRole",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.roles;null!==e&&(t=t.filter(function(t){return t.id!==e}),this.props.toggleRefreshRoles(!0)),this.setState({roles:t})}},{key:"render",value:function(){var e=this,t=this.state.roles.map(function(t){return{name:t.name,permissions:t.permissions,id:t.id,permission_ids:e.state.permission_ids}}).sort(function(e,t){return e.name.localeCompare(t.name)}),a=[{accessor:"name",label:"Role",priorityLevel:1,position:1,minWidth:50,sortable:!0},{accessor:"edit",label:"",priorityLevel:2,position:5,CustomComponent:Ee,minWidth:50,sortable:!1}],n={edit:this.deleteRole};return s.a.createElement("div",{className:"content"},s.a.createElement("h1",null,"User Roles"),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(S.a,{onClick:this.openModal},"New User Role")),s.a.createElement(we,{permission_ids:this.state.permission_ids,show:this.state.showModal,onSubmit:this.closeModal}),s.a.createElement(q.a,{rows:t,columns:a,column:"name",direction:"descending",showPagination:!0,callbacks:n}))}}]),t}(s.a.Component),Ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={row:{}},a.handleButtonClick=a.handleButtonClick.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"handleButtonClick",value:function(){var e=this;e.props.CustomFunction(e.state.row.ordering,"down")}},{key:"componentDidUpdate",value:function(){this.props.row.activity_id!==this.state.row.activity_id&&this.setState({row:this.props.row})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(S.a,{onClick:this.handleButtonClick},"Shift Down"))}}]),t}(s.a.Component),Se=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={row:{}},a.handleButtonClick=a.handleButtonClick.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row})}},{key:"handleButtonClick",value:function(){var e=this;e.props.CustomFunction(e.state.row.ordering,"up")}},{key:"componentDidUpdate",value:function(){this.props.row.activity_id!==this.state.row.activity_id&&this.setState({row:this.props.row})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(S.a,{bsStyle:"primary",onClick:this.handleButtonClick},"Shift Up"))}}]),t}(s.a.Component),_e=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).toggleCheckbox=function(){var e=Object(w.a)(Object(w.a)(a)),t={activity_id:e.state.row.activity_id,is_showing:!e.state.checked};U("http://".concat(R,"/api/activities/"),t).then(function(t){if("error"in t)console.log(t);else{e.props.CustomFunction(t)}})},a.state={row:{},checked:!1},a.toggleCheckbox=a.toggleCheckbox.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setState({row:this.props.row,checked:this.props.row.is_showing})}},{key:"componentDidUpdate",value:function(){this.props.row.is_showing!==this.state.checked&&this.setState({checked:this.props.row.is_showing})}},{key:"render",value:function(){return s.a.createElement("span",{className:"checkbox"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:this.state.checked,onChange:this.toggleCheckbox})))}}]),t}(n.Component),De=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(Q.a)({},e);return a[t]=n,a})},a.handleCheckbox=function(e){a.setState({inUse:!a.state.inUse})},a.state={show:!1,name:"",type:"boolean",inUse:!0,lastOrdering:0,error:!1,errorMsg:""},a.cancel=a.cancel.bind(Object(w.a)(Object(w.a)(a))),a.submit=a.submit.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.validateInput=a.validateInput.bind(Object(w.a)(Object(w.a)(a))),a.handleCheckbox=a.handleCheckbox.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.props.show!==this.state.show&&this.setState({show:this.props.show,lastOrdering:this.props.lastOrdering})}},{key:"validateInput",value:function(){var e=this.state.name;return e.length>0&&/^[a-z0-9.@+\-_]+$/i.test(e)&&this.state.type?"success":0===e.length?null:"error"}},{key:"cancel",value:function(){this.setState({name:"",type:"boolean",inUse:!0,lastOrdering:0,error:!1,errorMsg:""}),this.props.onSubmit()}},{key:"submit",value:function(){var e=this;if("success"===e.validateInput()){var t={name:e.state.name,ordering:e.state.lastOrdering+1,is_showing:e.state.inUse,type:e.state.type};T("http://".concat(R,"/api/activities/"),t).then(function(t){if("error"in t){if(400===t.error){return void e.setState({error:!0,errorMsg:"Creation failed due to invalid input. Please check your fields and try again"})}}else e.setState({name:"",type:"boolean",inUse:!0,lastOrdering:0,error:!1,errorMsg:""}),e.props.onSubmit(t)})}else{e.setState({error:!0,errorMsg:"Invalid input. Please check your fields and try again."})}}},{key:"render",value:function(){return s.a.createElement(ae.a,{show:this.props.show},s.a.createElement(ae.a.Header,null,s.a.createElement(ae.a.Title,null,"Create New Activity")),s.a.createElement(ae.a.Body,null,s.a.createElement("form",null,s.a.createElement(E.a,{validationState:this.validateInput()},s.a.createElement(j.a,null,"Activity Name"),s.a.createElement(C.a,{type:"text",name:"name",value:this.state.name,placeholder:"Activity Name",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(C.a,{componentClass:"select",name:"type",onChange:this.handleChange,defaultValue:this.state.type},s.a.createElement("option",{value:"boolean"},"Checkbox"),s.a.createElement("option",{value:"string"},"Text"),s.a.createElement("option",{value:"float"},"Number")),s.a.createElement("br",null),s.a.createElement(j.a,null,"Currently in Use"),s.a.createElement(C.a,{type:"checkbox",checked:this.state.inUse,value:this.state.inUse,onChange:this.handleCheckbox}),s.a.createElement(C.a.Feedback,null)))),s.a.createElement(ae.a.Footer,null,this.state.error&&s.a.createElement(_.a,{bsStyle:"danger"},this.state.errorMsg),s.a.createElement(S.a,{onClick:this.cancel},"Cancel"),s.a.createElement(S.a,{onClick:this.submit,bsStyle:"primary"},"Create")))}}]),t}(s.a.Component),xe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a=Object(Q.a)({},e);return a[t]=n,a})},a.state={activities:[],showModal:!1},a.patchActivityOrder=a.patchActivityOrder.bind(Object(w.a)(Object(w.a)(a))),a.createNewActivity=a.createNewActivity.bind(Object(w.a)(Object(w.a)(a))),a.swapOrder=a.swapOrder.bind(Object(w.a)(Object(w.a)(a))),a.updateCheckbox=a.updateCheckbox.bind(Object(w.a)(Object(w.a)(a))),a.getDataTypeName=a.getDataTypeName.bind(Object(w.a)(Object(w.a)(a))),a.handleChange=a.handleChange.bind(Object(w.a)(Object(w.a)(a))),a.openModal=a.openModal.bind(Object(w.a)(Object(w.a)(a))),a.closeModal=a.closeModal.bind(Object(w.a)(Object(w.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P("http://".concat(R,"/api/activities/"));case 3:t=e.sent,this.setState({activities:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"createNewActivity",value:function(e){return{activity_id:e.activity_id,type:e.type,ordering:e.ordering,is_showing:e.is_showing,name:e.name}}},{key:"patchActivityOrder",value:function(e,t){var a=this.state.activities,n=this,s={activity_id1:e,activity_id2:t};U("http://".concat(R,"/api/activities/"),s).then(function(e){if("error"in e[0]||"error"in e[1])console.log(e);else{var t=e[0],s=e[1];t&&s&&((a=(a=a.filter(function(e){return e.activity_id!==t.activity_id})).filter(function(e){return e.activity_id!==s.activity_id})).push(n.createNewActivity(t)),a.push(n.createNewActivity(s))),n.setState({activities:a})}})}},{key:"swapOrder",value:function(e,t){var a=this.state.activities;if(null!==e&&"up"===t&&e>1){var n=a.find(function(t){return t.ordering===e}),s=a.find(function(t){return t.ordering===e-1});this.patchActivityOrder(n.activity_id,s.activity_id)}else if(null!==e&&"down"===t&&e<a.length){var i=a.find(function(t){return t.ordering===e}),r=a.find(function(t){return t.ordering===e+1});this.patchActivityOrder(i.activity_id,r.activity_id)}}},{key:"updateCheckbox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.activities;null!==e&&(t=t.filter(function(t){return t.activity_id!==e.activity_id})).push(this.createNewActivity(e)),this.setState({activities:t})}},{key:"getDataTypeName",value:function(e){return"boolean"===e?"Checkbox":"string"===e?"Text":"float"===e?"Number":e}},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.state.activities;null!==e&&t.push(this.createNewActivity(e)),this.setState({showModal:!1,activities:t})}},{key:"render",value:function(){var e=this,t=this.state.activities.map(function(t){return{name:t.name,ordering:t.ordering,is_showing:t.is_showing,activity_id:t.activity_id,type:t.type,type_name:e.getDataTypeName(t.type)}}).sort(function(e,t){return e.ordering-t.ordering}),a=[{accessor:"name",label:"Activity",priorityLevel:1,position:1,minWidth:100,sortable:!1},{accessor:"type_name",label:"Data Type",priorityLevel:2,position:2,minWidth:100,sortable:!1},{accessor:"is_showing",label:"Currently in Use",priorityLevel:3,position:3,CustomComponent:_e,minWidth:50,sortable:!1},{accessor:"up",label:"",priorityLevel:4,position:4,CustomComponent:Se,minWidth:100,sortable:!1},{accessor:"down",label:"",priorityLevel:5,position:5,CustomComponent:Ce,minWidth:50,sortable:!1}],n={up:this.swapOrder,down:this.swapOrder,is_showing:this.updateCheckbox};return s.a.createElement("div",{className:"content"},s.a.createElement("h1",null,"Attendance Activities"),s.a.createElement(oe.a,{style:{float:"right"}},s.a.createElement(S.a,{onClick:this.openModal},"New Activity")),s.a.createElement(De,{show:this.state.showModal,lastOrdering:this.state.activities.length,onSubmit:this.closeModal}),s.a.createElement(q.a,{rows:t,columns:a,column:"name",direction:"descending",showPagination:!0,callbacks:n}))}}]),t}(s.a.Component),Ne=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).handleSelect=n.handleSelect.bind(Object(w.a)(Object(w.a)(n))),n.toggleRefreshRoles=n.toggleRefreshRoles.bind(Object(w.a)(Object(w.a)(n))),n.state={refreshRoles:!1,key:1},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleSelect",value:function(e){this.setState({key:e})}},{key:"toggleRefreshRoles",value:function(e){this.setState({refreshRoles:e})}},{key:"render",value:function(){return s.a.createElement(be.a,{activeKey:this.state.key,onSelect:this.handleSelect,id:"admin-tabs"},s.a.createElement(ve.a,{eventKey:1,title:"User Management"},s.a.createElement(ke,{toggleRefreshRoles:this.toggleRefreshRoles,refreshRoles:this.state.refreshRoles})),s.a.createElement(ve.a,{eventKey:2,title:"User Roles"},s.a.createElement(je,{toggleRefreshRoles:this.toggleRefreshRoles})),s.a.createElement(ve.a,{eventKey:3,title:"Attendance Activities"},s.a.createElement(xe,null)),s.a.createElement(ve.a,{eventKey:4,title:"Student Profile Fields"},"Tab 4 content"))}}]),t}(s.a.Component),Me=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=window.localStorage.getItem("permissions").split(",");return e.indexOf("view_user")>=0||e.indexOf("view_group")>=0?s.a.createElement("div",{className:"content"},s.a.createElement(Ne,null)):s.a.createElement(D.a,{to:"/attendance"})}}]),t}(s.a.Component),Ie=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"content"},s.a.createElement("p",null,"Alerts"))}}]),t}(s.a.Component),Ae=a(220),Re=a(219),Te=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"content"},s.a.createElement(Re.a,null,s.a.createElement("div",{className:"content-jumbotron"},s.a.createElement("h1",null,"404 ",s.a.createElement("small",null,"page not found")),s.a.createElement("p",null,"The page you're looking for has mysteriously disappeared! Try navigating from ",s.a.createElement(Ae.a,{to:"/attendance"},"the home page")," to take another look."))))}}]),t}(s.a.Component),Ue=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(k,{show:"/"!==this.props.location.pathname},s.a.createElement(h.a,null,s.a.createElement(m.a,{exact:!0,path:"/",component:G}),s.a.createElement(m.a,{exact:!0,path:"/attendance",render:function(){return H(ce)}}),s.a.createElement(m.a,{path:"/students",component:function(e){return H(me)}})," ",s.a.createElement(m.a,{path:"/reports",render:function(){return H(pe)}}),s.a.createElement(m.a,{path:"/admin",render:function(){return H(Me)}}),s.a.createElement(m.a,{path:"/alerts",render:function(){return H(Ie)}}),s.a.createElement(m.a,{render:function(){return H(Te)}})))}}]),t}(s.a.Component),Pe=Object(p.a)(Ue),Le=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(Pe,{history:A}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Fe=a(225);r.a.render(s.a.createElement(Fe.a,null,s.a.createElement(Le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},84:function(e,t,a){e.exports=a.p+"static/media/blank_profile_pic.9a344a6c.jpg"}},[[114,2,1]]]);
//# sourceMappingURL=main.ae0107bb.chunk.js.map